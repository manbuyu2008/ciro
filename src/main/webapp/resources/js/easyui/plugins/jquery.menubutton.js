(function(b){function c(g){var f=b.data(g,"menubutton").options;var d=b(g);if(!d.attr("id")){d.attr("id",b.parser.getObjGUID())}d.removeClass("m-btn-active m-btn-plain-active").addClass("m-btn");d.linkbutton(b.extend({},f,{text:f.text+'<span class="m-btn-downarrow">&nbsp;</span>'}));if(f.menu){var e=b(f.menu);e.attr("parentbtnid",d.attr("id"));e.menu({onShow:function(){var h=b("#"+b(this).attr("parentbtnid"));var i=b.data(h[0],"menubutton").options;h.addClass((i.plain==true)?"m-btn-plain-active":"m-btn-active")},onHide:function(){var h=b("#"+b(this).attr("parentbtnid"));var i=b.data(h[0],"menubutton").options;h.removeClass((i.plain==true)?"m-btn-plain-active":"m-btn-active")}})}a(g,f.disabled)}function a(i,f){var g=b.data(i,"menubutton").options;g.disabled=f;var e=b(i);if(f){e.linkbutton("disable");e.unbind(".menubutton")}else{e.linkbutton("enable");e.unbind(".menubutton");e.bind("click.menubutton",function(){var j=b.data(this,"menubutton").options;d(j,this);return false});var h=null;e.bind("mouseenter.menubutton",function(){var k=b.data(this,"menubutton").options;var j=this;h=setTimeout(function(){d(k,j)},k.duration);return false}).bind("mouseleave.menubutton",function(){if(h){clearTimeout(h)}})}function d(k,m){if(!k.menu){return}var j=b(m);var l=j.offset().left;if(l+b(k.menu).outerWidth()+5>document.body.clientWidth){l=document.body.clientWidth-b(k.menu).outerWidth()-5}b("body>div.menu-top").menu("hide");b(k.menu).menu("show",{left:l,top:j.offset().top+j.outerHeight()});j.blur()}}b.fn.menubutton=function(d,e){if(typeof d=="string"){return b.fn.menubutton.methods[d](this,e)}d=d||{};return this.each(function(f){var g=b.data(this,"menubutton");if(g){b.extend(g.options,f)}else{b.data(this,"menubutton",{options:b.extend({},b.fn.menubutton.defaults,b.fn.menubutton.parseOptions(this),f)});b(this).prop("disabled",false)}c(this)},[d])};b.fn.menubutton.methods={options:function(d){return b.data(d[0],"menubutton").options},enable:function(d){return d.each(function(){a(this,false)})},disable:function(d){return d.each(function(){a(this,true)})},destroy:function(d){return d.each(function(){var e=b(this).menubutton("options");if(e.menu){b(e.menu).menu("destroy")}b(this).remove()})}};b.fn.menubutton.parseOptions=function(d){return b.extend({},b.fn.linkbutton.parseOptions(d),b.parser.parseOptions(d,["menu",{plain:"boolean",duration:"number"}]))};b.fn.menubutton.defaults=b.extend({},b.fn.linkbutton.defaults,{plain:true,menu:null,duration:100})})(jQuery);