(function(d){function f(i,j,h){if(!h){h=d.data(i,"window")}var g=h.options;if(j){if(j.width){g.width=j.width}if(j.height){g.height=j.height}if(j.left!=null){g.left=j.left}if(j.top!=null){g.top=j.top}}d(i).panel("resize",g)}function c(h,i,g){if(!g){g=d.data(h,"window")}if(i){if(i.left!=null){g.options.left=i.left}if(i.top!=null){g.options.top=i.top}}d(h).panel("move",g.options);if(g.shadow){g.shadow.css({left:g.options.left,top:g.options.top})}}function b(m,k){if(!k){k=d.data(m,"window")}var h=d(m);if(!h.attr("id")){h.attr("id",d.parser.getObjGUID())}var l=h.panel(d.extend({},k.options,{border:false,doSize:true,closed:true,cls:"window",headerCls:"window-header",bodyCls:"window-body "+(k.options.noheader?"window-body-noheader":""),onBeforeDestroy:function(){var o=this;var n=d.data(o,"window");if(n.options.onBeforeDestroy.call(o)==false){return false}if(n.shadow){n.shadow.remove()}if(n.mask){n.mask.remove()}},onClose:function(){var o=this;var n=d.data(o,"window");if(n.shadow){n.shadow.hide()}if(n.mask){n.mask.hide()}n.options.onClose.call(o)},onOpen:function(){var o=this;var n=d.data(o,"window");if(n.mask){n.mask.css({display:"block",zIndex:d.fn.window.defaults.zIndex++})}if(n.shadow){n.shadow.css({display:"block",zIndex:d.fn.window.defaults.zIndex++,left:n.options.left,top:n.options.top,width:n.window.outerWidth(),height:n.window.outerHeight()})}n.window.css("z-index",d.fn.window.defaults.zIndex++);n.options.onOpen.call(o)},onResize:function(o,n){var r=this;var q=d.data(r,"window");var p=d(r).panel("options");q.options.width=p.width;q.options.height=p.height;q.options.left=p.left;q.options.top=p.top;if(q.shadow){q.shadow.css({left:q.options.left,top:q.options.top,width:q.window.outerWidth(),height:q.window.outerHeight()})}q.options.onResize.call(r,o,n)},onMinimize:function(){var o=this;var n=d.data(o,"window");if(n.shadow){n.shadow.hide()}if(n.mask){n.mask.hide()}n.options.onMinimize.call(o)},onBeforeCollapse:function(){var o=this;var n=d.data(o,"window");if(n.options.onBeforeCollapse.call(o)==false){return false}if(n.shadow){n.shadow.hide()}},onExpand:function(){var o=this;var n=d.data(o,"window");if(n.shadow){n.shadow.show()}n.options.onExpand.call(o)}}));k.window=l.panel("panel");if(k.mask){k.mask.remove()}if(k.options.modal==true){k.mask=d('<div class="window-mask"></div>').insertAfter(k.window);k.mask.css({width:(k.options.inline?k.mask.parent().width():e().width),height:(k.options.inline?k.mask.parent().height():e().height),display:"none"})}if(k.shadow){k.shadow.remove()}if(k.options.shadow==true){k.shadow=d('<div class="window-shadow"></div>').insertAfter(k.window);k.shadow.css({display:"none"})}var j;if(k.options.left==null){var i=k.options.width;if(isNaN(i)){i=k.window.outerWidth()}if(k.options.inline){j=k.window.parent();k.options.left=(j.width()-i)/2+j.scrollLeft()}else{k.options.left=(document.body.clientWidth-i)/2+d(document).scrollLeft()}}if(k.options.top==null){var g=k.window.height;if(isNaN(g)){g=k.window.outerHeight()}if(k.options.inline){j=k.window.parent();k.options.top=(j.height()-g)/2+j.scrollTop()}else{k.options.top=(document.body.clientHeight-g)/2+d(document).scrollTop()}}c(m,undefined,k);if(k.options.closed==false){l.window("open")}}function a(h,g){if(!g){g=d.data(h,"window")}g.window.draggable({handle:">div.panel-header>div.panel-title",disabled:g.options.draggable==false,onStartDrag:function(l){var i=d("#"+d(this).attr("targetid"));var k=i[0],j=d.data(k,"window");if(j.mask){j.mask.css("z-index",d.fn.window.defaults.zIndex++)}if(j.shadow){j.shadow.css("z-index",d.fn.window.defaults.zIndex++)}j.window.css("z-index",d.fn.window.defaults.zIndex++);if(!j.proxy){j.proxy=d('<div class="window-proxy"></div>').insertAfter(j.window)}j.proxy.css({display:"none",zIndex:d.fn.window.defaults.zIndex++,left:l.data.left,top:l.data.top});j.proxy._outerWidth(j.window.outerWidth());j.proxy._outerHeight(j.window.outerHeight());setTimeout(function(){if(j.proxy){j.proxy.show()}},500)},onDrag:function(k){var j=d("#"+d(this).attr("targetid"))[0],i=d.data(j,"window");i.proxy.css({display:"block",left:k.data.left,top:k.data.top});return false},onStopDrag:function(l){var i=d("#"+d(this).attr("targetid"));var k=i[0],j=d.data(k,"window");j.options.left=l.data.left;j.options.top=l.data.top;i.window("move");j.proxy.remove();j.proxy=null}});g.window.resizable({disabled:g.options.resizable==false,onStartResize:function(l){var i=d("#"+d(this).attr("targetid"));var k=i[0],j=d.data(k,"window");j.pmask=d('<div class="window-proxy-mask"></div>').insertAfter(j.window);j.pmask.css({zIndex:d.fn.window.defaults.zIndex++,left:l.data.left,top:l.data.top,width:j.window.outerWidth(),height:j.window.outerHeight()});if(!j.proxy){j.proxy=d('<div class="window-proxy"></div>').insertAfter(j.window)}j.proxy.css({zIndex:d.fn.window.defaults.zIndex++,left:l.data.left,top:l.data.top});j.proxy._outerWidth(l.data.width);j.proxy._outerHeight(l.data.height)},onResize:function(l){var i=d("#"+d(this).attr("targetid"));var k=i[0],j=d.data(k,"window");j.proxy.css({left:l.data.left,top:l.data.top});j.proxy._outerWidth(l.data.width);j.proxy._outerHeight(l.data.height);return false},onStopResize:function(l){var i=d("#"+d(this).attr("targetid"));var k=i[0],j=d.data(k,"window");j.options.left=l.data.left;j.options.top=l.data.top;j.options.width=l.data.width;j.options.height=l.data.height;f(k,undefined,j);j.pmask.remove();j.pmask=null;j.proxy.remove();j.proxy=null}})}function e(){if(document.compatMode=="BackCompat"){return{width:Math.max(document.body.scrollWidth,document.body.clientWidth),height:Math.max(document.body.scrollHeight,document.body.clientHeight)}}else{return{width:Math.max(document.documentElement.scrollWidth,document.documentElement.clientWidth),height:Math.max(document.documentElement.scrollHeight,document.documentElement.clientHeight)}}}d(window).resize(function(){d("body>div.window-mask").css({width:document.body.clientWidth,height:document.body.clientHeight});setTimeout(function(){var g=e();d("body>div.window-mask").css({width:g.width,height:g.height})},50)});d.fn.window=function(g,h){if(typeof g=="string"){var i=d.fn.window.methods[g];if(i){return i(this,h)}else{return this.panel(g,h)}}g=g||{};return this.each(function(j){var k=d.data(this,"window");if(k){d.extend(k.options,j)}else{k=d.data(this,"window",{options:d.extend({},d.fn.window.defaults,d.fn.window.parseOptions(this),j)});if(!k.options.inline){d(this).appendTo("body")}}b(this,k);a(this,k)},[g])};d.fn.window.methods={options:function(i){var h=i.panel("options");var g=d.data(i[0],"window").options;return d.extend(g,{closed:h.closed,collapsed:h.collapsed,minimized:h.minimized,maximized:h.maximized})},window:function(g){return d.data(g[0],"window").window},resize:function(h,g){return h.each(function(){f(this,g)})},move:function(h,g){return h.each(function(){c(this,g)})}};d.fn.window.parseOptions=function(g){return d.extend({},d.fn.panel.parseOptions(g),d.parser.parseOptions(g,[{draggable:"boolean",resizable:"boolean",shadow:"boolean",modal:"boolean",inline:"boolean"}]))};d.fn.window.defaults=d.extend({},d.fn.panel.defaults,{zIndex:9000,draggable:true,resizable:true,shadow:true,modal:false,inline:false,title:"New Window",collapsible:true,minimizable:true,maximizable:true,closable:true,closed:false})})(jQuery);