(function(d){function f(r,q){if(!q){q=d.data(r,"accordion")}var p=q.options;var x=q.panels;var s=d(r);p.fit?d.extend(p,s._fit()):s._fit(false);if(p.width>0){s._outerWidth(p.width)}var y="auto";if(p.height>0){s._outerHeight(p.height);var u=x.length?x[0].panel("header").css("height","")._outerHeight():"auto";y=s.height()-(x.length-1)*u}for(var t=0,w=x.length;t<w;t++){var o=x[t];var v=o.panel("header");v._outerHeight(u);o.panel("resize",{width:s.width(),height:y})}}function g(q,t){if(!t){t=d.data(q,"accordion")}var r=t.panels;for(var s=0,o=r.length;s<o;s++){var p=r[s];if(p.panel("options").collapsed==false){return p}}return null}function n(r,q,u){if(!u){u=d.data(r,"accordion")}var s=u.panels,v=d(q)[0];for(var t=0,o=s.length;t<o;t++){if(s[t][0]==v){return t}}return -1}function h(q,v,t,u){if(!u){u=d.data(q,"accordion")}var r=u.panels,p;if(typeof v=="number"){if(v<0||v>=r.length){return null}else{p=r[v];if(t){r.splice(v,1)}return p}}for(var s=0,o=r.length;s<o;s++){p=r[s];if(p.panel("options").title==v){if(t){r.splice(s,1)}return p}}return null}function b(o,q){if(!q){q=d.data(o,"accordion")}var p=q.options;var r=d(o);if(p.border){r.removeClass("accordion-noborder")}else{r.addClass("accordion-noborder")}}function j(o){var q=d(o);q.addClass("accordion");var p=[];q.children("div").each(function(s){var t=d.extend({},d.parser.parseOptions(this),{selected:(d(this).prop("selected")?true:undefined)});var r=d(this);p.push(r);k(s,r,t)},[o]);q.bind("_resize",function(v,u){var r=this;var t=d.data(r,"accordion");var s=t.options;if(s.fit==true||u){f(r,t)}return false});return{accordion:q,panels:p}}function k(p,o,q){o.panel(d.extend({},q,{collapsible:false,minimizable:false,maximizable:false,closable:false,doSize:false,collapsed:true,headerCls:"accordion-header",bodyCls:"accordion-body",onBeforeExpand:function(){var v=d(this);var u=v.parents("div.accordion")[0];var w=g(u),x;if(w){x=d(w).panel("header");x.removeClass("accordion-header-selected");x.find(".accordion-collapse").triggerHandler("click")}x=v.panel("header");x.addClass("accordion-header-selected");x.find(".accordion-collapse").removeClass("accordion-expand")},onExpand:function(){var u=d(this),t=u.parents("div.accordion")[0];var w=d.data(t,"accordion");var v=w.options;v.onSelect.call(t,u.panel("options").title,n(t,this,w))},onBeforeCollapse:function(){var t=d(this).panel("header");t.removeClass("accordion-header-selected");t.find(".accordion-collapse").addClass("accordion-expand")}}));var s=o.panel("header");var r=d('<a class="accordion-collapse accordion-expand" href="javascript:void(0)"></a>').appendTo(s.children("div.panel-tool"));r.bind("click",function(y){var x=d(this);var u=x.parents("div.accordion")[0];var w=d.data(u,"accordion");var v=w.options.animate;var t=d(d(x.parents("div.panel-header")[0]).next("div.panel-body")[0]);a(u,w);if(t.panel("options").collapsed){t.panel("expand",v)}else{t.panel("collapse",v)}return false});s.click(function(){d(this).find(".accordion-collapse").triggerHandler("click");return false})}function i(p,s,q){if(!q){q=d.data(p,"accordion")}var o=h(p,s,false,q);if(!o){return}var r=g(p,q);if(r&&r[0]==o[0]){return}o.panel("header").triggerHandler("click")}function m(p,t){if(!t){t=d.data(p,"accordion")}var q=t.panels;for(var s=0,o=q.length;s<o;s++){if(q[s].panel("options").selected){r(s,p,t);return}}if(q.length){r(0,p,t)}function r(w,u,y){var x=y.options;var v=x.animate;x.animate=false;i(u,w,y);x.animate=v}}function a(p,s){if(!s){s=d.data(p,"accordion")}var q=s.panels;for(var r=0,o=q.length;r<o;r++){q[r].stop(true,true)}}function l(p,r){var t=d.data(p,"accordion");var s=t.options;var q=t.panels;if(r.selected==undefined){r.selected=true}a(p,t);var o=d("<div></div>").appendTo(p);q.push(o);k(p,o,r);f(p,t);s.onAdd.call(p,r.title,q.length-1);if(r.selected){i(p,q.length-1,t)}}function c(r,s){var q=d.data(r,"accordion");var o=q.options;var u=q.panels;a(r,q);var p=h(r,s,false,q);if(!p){return}var v=p.panel("options").title;var t=n(r,p,q);if(o.onBeforeRemove.call(r,v,t)==false){return}u.splice(t,1);p.panel("destroy");if(u.length){f(r,q);var w=g(r,q);if(!w){i(r,0,q)}}o.onRemove.call(r,v,t)}function e(p){var t=d.data(p,"accordion");var s=t.options;var q=t.panels,o;a(p,t);if(s.onBeforeRemove.call(p)==false){return}for(var r=q.length-1;r>=0;r--){o=q[r];q.splice(r,1);if(o){o.panel("destroy")}}f(p,t);s.onRemove.call(p)}d.fn.accordion=function(o,p){if(typeof o=="string"){return d.fn.accordion.methods[o](this,p)}o=o||{};return this.each(function(q){var u=d.data(this,"accordion");var t;if(u){t=d.extend(u.options,q);u.opts=t}else{t=d.extend({},d.fn.accordion.defaults,d.fn.accordion.parseOptions(this),q);var s=j(this);u=d.data(this,"accordion",{options:t,accordion:s.accordion,panels:s.panels})}b(this,u);f(this,u);m(this,u)},[o])};d.fn.accordion.methods={options:function(o){return d.data(o[0],"accordion").options},panels:function(o){return d.data(o[0],"accordion").panels},resize:function(o){return o.each(function(){f(this)})},getSelected:function(o){return g(o[0])},getPanel:function(p,o){return h(p[0],o)},getPanelIndex:function(p,o){return n(p[0],o)},select:function(p,o){return p.each(function(){i(this,o)})},add:function(p,o){return p.each(function(){l(this,o)})},remove:function(p,o){return p.each(function(){c(this,o)})},clear:function(o){return o.each(function(){e(this)})}};d.fn.accordion.parseOptions=function(o){return d.extend({},d.parser.parseOptions(o,["width","height",{fit:"boolean",border:"boolean",animate:"boolean"}]))};d.fn.accordion.defaults={width:"auto",height:"auto",fit:false,border:true,animate:true,onSelect:function(p,o){},onAdd:function(p,o){},onBeforeRemove:function(p,o){},onRemove:function(p,o){}}})(jQuery);