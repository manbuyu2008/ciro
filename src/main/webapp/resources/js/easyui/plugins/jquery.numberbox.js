(function($){function g(k){var i=$('<input type="hidden">').insertAfter(k);if(!this.id){this.id=$.parser.getObjGUID()}var j=$(k).attr("name");if(j){i.attr("name",j);$(k).removeAttr("name").attr("numberboxName",j)}return i}function a(l){var k=$.data(l,"numberbox"),i=$(l);var j=k.options;var m=i.val()+"";if(j.onGetValue){m=j.onGetValue(m,j.precision)}else{m=m.toDouble(j.precision)}i.val(m);k.field.val(m);i.select()}function c(k){var j=$.data(k,"numberbox").options;var i=j.onChange;j.onChange=function(){};f(k,j.parser.call(k,j.value));j.onChange=i}function b(i){return $.data(i,"numberbox").field.val()}function f(m,l){var k=$.data(m,"numberbox");var j=k.options;var i=b(m);l=j.parser.call(m,l);j.value=l;k.field.val(l);$(m).val(j.formatter.call(m,l));$(m).numberbox("validate");if(i!=l){j.onChange.call(m,l,i)}}function h(i){$(i).unbind(".numberbox").bind("keypress.numberbox",function(k){if(k.which==45){var j=getInputSelection(this.id)+"";return j.indexOf("-")>=0||$(this).val().indexOf("-")<0}if(k.which==46){var j=getInputSelection(this.id)+"";return j.indexOf(".")>=0||$(this).val().indexOf(".")<0}else{if((k.which>=48&&k.which<=57&&k.ctrlKey==false&&k.shiftKey==false)||k.which==0||k.which==8){return true}else{return k.ctrlKey==true&&(k.which==99||k.which==118)}}}).bind("paste.numberbox",function(){if(window.clipboardData){var j=clipboardData.getData("text");return !/\D/.test(j)}else{return false}}).bind("dragenter.numberbox",function(){return false}).bind("blur.numberbox",function(){f(this,$(this).val());var j=$.data(this,"numberbox").options;$(this).val(j.formatter.call(this,b(this)));$(this).trigger("change")}).bind("focus.numberbox",function(){a(this);var j=b(this);if($(this).val()!=j){$(this).val(j)}})}function e(j){if($.fn.validatebox){var i=$.data(j,"numberbox").options;$(j).validatebox(i)}}function d(k,i){var j=$.data(k,"numberbox").options;if(i){j.disabled=true;$(k).prop("disabled",true)}else{j.disabled=false;$(k).prop("disabled",false)}}$.fn.numberbox=function(i,j){if(typeof i=="string"){var k=$.fn.numberbox.methods[i];if(k){return k(this,j)}else{return this.validatebox(i,j)}}i=i||{};return this.each(function(l){var m=$.data(this,"numberbox");if(m){$.extend(m.options,l)}else{m=$.data(this,"numberbox",{options:$.extend({},$.fn.numberbox.defaults,$.fn.numberbox.parseOptions(this),l),field:g(this)});$(this).prop("disabled",false);$(this).css({imeMode:"disabled"})}d(this,m.options.disabled);h(this);e(this);c(this)},[i])};$.fn.numberbox.methods={options:function(i){return $.data(i[0],"numberbox").options},destroy:function(i){return i.each(function(){$.data(this,"numberbox").field.remove();$(this).validatebox("destroy");$(this).remove()})},disable:function(i){return i.each(function(){d(this,true)})},enable:function(i){return i.each(function(){d(this,false)})},fix:function(i){return i.each(function(){f(this,$(this).val())})},setValue:function(j,i){return j.each(function(){f(this,i)})},getValue:function(i){return b(i[0])},clear:function(i){return i.each(function(){var j=$.data(this,"numberbox");j.field.val("");$(this).val("")})}};$.fn.numberbox.parseOptions=function(j){var i=$(j);return $.extend({},$.fn.validatebox.parseOptions(j),$.parser.parseOptions(j,["decimalSeparator","groupSeparator","prefix","suffix",{min:"number",max:"number",precision:"number"}]),{disabled:(i.prop("disabled")?true:undefined),value:(i.val()||undefined)})};$.fn.numberbox.defaults=$.extend({},$.fn.validatebox.defaults,{disabled:false,value:"",min:null,max:null,precision:0,decimalSeparator:".",groupSeparator:",",prefix:"",suffix:"",zeroEmpty:true,canNull:false,formatter:function(m){if(!m){return m}m=m+"";var k=$(this).numberbox("options");if(k.zeroEmpty&&m==0){return""}var j=m,i="";var l=m.indexOf(".");if(l>=0){j=m.substring(0,l);i=m.substring(l+1,m.length)}if(k.groupSeparator){var n=/(\d+)(\d{3})/;while(n.test(j)){j=j.replace(n,"$1"+k.groupSeparator+"$2")}}if(i){return k.prefix+j+k.decimalSeparator+i+k.suffix}else{return k.prefix+j+k.suffix}},parser:function(i){i=i+"";var j=$(this).numberbox("options");if(j.groupSeparator){i=i.replace(new RegExp("\\"+j.groupSeparator,"g"),"")}if(j.decimalSeparator){i=i.replace(new RegExp("\\"+j.decimalSeparator,"g"),".")}if(j.prefix){i=i.replace(new RegExp("\\"+$.trim(j.prefix),"g"),"")}if(j.suffix){i=i.replace(new RegExp("\\"+$.trim(j.suffix),"g"),"")}i=i.replace(/\s/g,"");var k=parseFloat(i).toFixed(j.precision);if(isNaN(k)){if(!i&&j.canNull){k=""}else{k="0"}}else{if(typeof(j.min)=="number"&&k<j.min){k=j.min.toFixed(j.precision)}else{if(typeof(j.max)=="number"&&k>j.max){k=j.max.toFixed(j.precision)}}}if(j.onFormatter){k=j.onFormatter(k,j.precision)}else{}return k},onChange:function(j,i){}})})(jQuery);