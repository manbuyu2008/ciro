(function($){var r=0;function P(at,au,aq){if(!aq){aq=$.data(at,"datagrid")}var ap=aq.options;var ao=aq.panel;if(au){if(au.width){ap.width=au.width}if(au.height){ap.height=au.height}}if(ap.fit==true){var ar=ao.panel("panel").parent();ap.width=ar.width();ap.height=ar.height()}ao.panel("resize",{width:ap.width,height:ap.height});var an=$("div.datagrid-toolbar>input.datagrid-search",ao);if(an.length>0){an._outerWidth(ap.width)}}function J(aG,ap){if(!ap){ap=$.data(aG,"datagrid")}var aw=ap.options;var aF=ap.dc;var aq=ap.panel;var az=aq.width();var aA=aq.height();var au=aF.view;var aD=aF.view1;var aB=aF.view2;var av,aE,at,aC;au.width(az);av=aD.children("div.datagrid-header");aE=av.find("table");var ay=av.children("div.datagrid-header-inner").show();aD.width(ay.find("table").width());if(!aw.showHeader){ay.hide()}az-=aD._outerWidth();aD.children("div.datagrid-header,div.datagrid-body,div.datagrid-footer,div.datagrid-editor").width(aD.width());av.css("height","");aE.css("height","");at=aB.children("div.datagrid-header");aC=at.find("table");aB.width(az);aB.children("div.datagrid-header,div.datagrid-body,div.datagrid-footer,div.datagrid-editor").width(aB.width());at.css("height","");aC.css("height","");var ao=Math.max(aE.height(),aC.height());aE.height(ao);av._outerHeight(ao);aC.height(ao);at._outerHeight(ao);if(!ap.data||!ap.data.rows||ap.data.rows.length==0){ay=at.children("div.datagrid-header-inner").show();aF.body2.children("div.datagrid-emptybody").width(ay.find("table").width()).height(1);if(!aw.showHeader){ay.hide()}}if(aw.height!="auto"){function an(aI,aH){if(aH){return aI-=aH}return aI}var ax=aA;ax=an(ax,aB.children("div.datagrid-header")._outerHeight());ax=an(ax,aB.children("div.datagrid-footer")._outerHeight());ax=an(ax,aq.children("div.datagrid-toolbar")._outerHeight());aq.children("div.datagrid-pager").each(function(){ax-=$(this)._outerHeight()});aD.children("div.datagrid-body").height(ax);aB.children("div.datagrid-body").height(ax)}au.height(aB.height());var ar=aD._outerWidth();aB.css("left",ar?ar:0)}function l(aw,av,au,ap){if(!ap){ap=$.data(aw,"datagrid")}var ao=ap.options;var ay=ap.dc;if(!ay.body1.is(":empty")&&(!ao.nowrap||ao.autoRowHeight||au)){var at,ar;if(av!=undefined){at=ao.finder.getTr(aw,av,"body",1,ap);ar=ao.finder.getTr(aw,av,"body",2,ap);n(at,ar)}else{at=ao.finder.getTr(aw,0,"allbody",1,ap);ar=ao.finder.getTr(aw,0,"allbody",2,ap);n(at,ar);if(ao.showFooter){at=ao.finder.getTr(aw,0,"allfooter",1,ap);ar=ao.finder.getTr(aw,0,"allfooter",2,ap);n(at,ar)}}}J(aw,ap);if(ao.height=="auto"){var an=ay.body1.parent();var az=ay.body2;var ax=0;var aq=0;az.children().each(function(){var aA=$(this);if(aA.is(":visible")){ax+=aA._outerHeight();aq=Math.max(aq,aA._outerWidth())}});if(aq>az.width()){ax+=18}an.height(ax);az.height(ax);ay.view.height(ay.view2.height())}ay.body2.triggerHandler("scroll")}function n(ar,aq){for(var at=0,ap=aq.length;at<ap;at++){var ao=$(ar[at]);var au=$(aq[at]);var an=Math.max(ao.height(),au.height());ao.css("height",an);au.css("height",an)}}function N(at,aE){var aq=$(at);var ao=$('<div class="datagrid-wrap"><div class="datagrid-view eap-container" id='+$.parser.getObjGUID()+"></div></div>").insertAfter(at);var az=null,au=null;if(aE.canHideColumn){az=$('<div class="hide-column-button" style="z-index: 10">&nbsp;</div>').appendTo("body");var av=[];av.push('<div class="hide-column-fields" style="width:'+aE.hideColComboWidth+'px;z-index:11">');aB(aE.columns,av);av.push("</div>");au=$(av.join("")).appendTo("body");if(au.height()>200){au.height(200)}}function aB(aK,aJ){function aL(aQ){if($$str.isEmpty(aQ)){return""}aQ=aQ+"";aQ=aQ.replace(/<br>/g,"\n");aQ=aQ.replace(/&nbsp;/g," ");if(aQ.indexOf("<")<0||aQ.indexOf(">")<0){return aQ}try{var aO=$(aQ).text();if($$str.isEmpty(aO)){return aQ}return aO}catch(aP){return aQ}}function aM(aT,aQ,aU){if(!aU){aU=aL(aT.title)}var aS=aK[aQ];var aR=0,aO=aT.colspan;while(aR<aO){var aP=aS[0];aS.splice(0,1);if(aP.checkbox||aP.opt||!aP.title){aR++;continue}if(aP.field){aI(aP,aU)}else{aM(aP,aQ+1,aU+"-"+aL(aP.title))}aR+=(aP.colspan&&aP.colspan>0)?aP.colspan:1}}function aI(aO,aQ){var aP=!aO.hidden?"checked='checked'":"";var aR=aL(aO.title);if(aQ){aR=aQ+"-"+aR}aJ.push("<input type='checkbox' value='"+aO.field+"'"+aP+" />&nbsp;&nbsp;"+aR);aJ.push("<br>")}if(!aK||aK.length==0){return}var aN=aK,aF;aK=[];var aG,aH;for(aG=0,aH=aN.length;aG<aH;aG++){aK.push(aN[aG].concat())}for(aG=0,aH=aK[0].length;aG<aH;aG++){aF=aK[0][aG];if(aF.checkbox||aF.opt||!aF.title){continue}if(aF.field){aI(aF)}else{aM(aF,1)}}}ao.panel({doSize:false});ao.panel("panel").addClass("datagrid").bind("_resize",{target:at},function(aJ,aH){var aI=aJ.data.target;var aF=$.data(aI,"datagrid");var aG=aF.options;$("div.hide-column-fields").hide();$("div.hide-column-button").hide();if(aG.fit==true||aH){P(aI,undefined,aF);L(aI,undefined,aF)}return false});aq.hide().appendTo(ao.children("div.datagrid-view"));var ax=ao.children("div.datagrid-view");var ay,aw;if(aE.rownumbers||(aE.frozenColumns&&aE.frozenColumns.length>0)){ay=$('<div class="datagrid-view1"><div class="datagrid-body"><div class="datagrid-body-inner"></div></div></div>').appendTo(ax)}else{ay=$()}aw=$('<div class="datagrid-view2"><div class="datagrid-body"></div></div>').appendTo(ax);var an=ay.children("div.datagrid-body").children("div.datagrid-body-inner"),aD=aw.children("div.datagrid-body");return{panel:ao,dc:{view:ax,view1:ay,view2:aw,header1:aA(ay),header2:aA(aw),body1:an,body2:aD,footer1:ap(ay,aE),footer2:ap(aw,aE),editor1:aC(an,aE),editor2:aC(aD,aE),editorTool:ar(ax,aE),hideColBtn:az,hideColFields:au}};function aA(aG){if(aG.length>0){var aF=$('<div class="datagrid-header"><div class="datagrid-header-inner"></div></div>').prependTo(aG);return aF.children(".datagrid-header-inner")}return $()}function ap(aG,aH){if(aG.length>0&&aH.showFooter){var aF=$('<div class="datagrid-footer"><div class="datagrid-footer-inner"></div></div>').appendTo(aG);return aF.children(".datagrid-footer-inner")}return $()}function aC(aF,aG){if(aF.length>0&&!aG.readonly){return $('<div class="datagrid-editor"></div>').hide().appendTo(aF)}return $()}function ar(aF,aH){if(!aH.readonly&&aH.showEditorTool){var aG=$('<div class="datagrid-editor-toolbar" style="display: none;"></div>').appendTo(aF);if(aH.rownumbers){aG.css("left","25px")}$('<a href="javascript:void(0)"></a>').css("float","left").bind("click",{target:at},function(aJ){var aI=aJ.data.target;w(aI,false)}).appendTo(aG).linkbutton({text:"确定",iconCls:"icon-ok",plain:true});return aG}return $()}}function m(aF,ar){if(!ar){ar=$.data(aF,"datagrid")}var az=ar.options;var aE=ar.dc;var ay=ar.panel,ao=$(aF),ap;if(!ao.attr("id")){ap=$.parser.getObjGUID();ao.attr("id",ap)}else{ap=ao.attr("id")}ay.panel($.extend({},az,{id:null,doSize:false,onResize:function(aI,aH){setTimeout(function(){var aK=$("#"+ap)[0];var aJ=$.data(aK,"datagrid");if(aJ){J(aK,aJ);o(aK,aJ);aJ.options.onResize.call(aJ.panel,aI,aH)}},0)},onExpand:function(){var aH=$("#"+ap)[0];l(aH);az.onExpand.call(this)}}));ar.rowIdPrefix="datagrid-row-r"+(++r);av(aE.header1,az.frozenColumns,true,0);var aD=az.frozenColumns?az.frozenColumns.length+1:0;av(aE.header2,az.columns,false,aD);aw(aF,ar);aE.header1.add(aE.header2).css("display",az.showHeader?"block":"none");aE.footer1.add(aE.footer2).css("display",az.showFooter?"block":"none");ar.search=undefined;if(az.canSearch){an(ar)}var aG;if(az.toolbar){if(typeof az.toolbar=="string"){aG=$(az.toolbar);aG.addClass("datagrid-toolbar").prependTo(ay);aG.show()}else{$("div.datagrid-toolbar",ay).remove();aG=$('<div class="datagrid-toolbar"></div>').prependTo(ay);for(var aB=0,aC=az.toolbar.length;aB<aC;aB++){var au=az.toolbar[aB];if(au=="-"){$('<div class="datagrid-btn-separator"></div>').appendTo(aG)}else{var aq=$('<a href="javascript:void(0)"></a>');aq[0].onclick=eval(au.handler||function(){});aq.css("float","left").appendTo(aG).linkbutton($.extend({},au,{plain:true}))}}}if(az.showSearch){aA(aF,aG,ar)}}else{if(az.showSearch){$("div.datagrid-toolbar",ay).remove();aG=$('<div class="datagrid-toolbar"></div>').prependTo(ay);aA(aF,aG,ar)}else{$("div.datagrid-toolbar",ay).remove()}}$("div.datagrid-pager",ay).remove();if(az.pagination){var ax=$('<div class="datagrid-pager" parentId="'+ap+'"></div>');if(az.pagePosition=="bottom"){ax.appendTo(ay)}else{if(az.pagePosition=="top"){ax.addClass("datagrid-pager-top").prependTo(ay)}else{var at=$('<div class="datagrid-pager datagrid-pager-top"></div>').prependTo(ay);ax.appendTo(ay);ax=ax.add(at)}}ax.pagination({showPageList:az.showPageList,pageNumber:az.pageNumber,pageSize:az.pageSize,pageList:az.pageList,showRefresh:az.pageShowRefresh,showLast:az.pageShowLast,readonly:az.pageReadonly,onSelectPage:function(aK,aH){var aL=$("#"+$(this).attr("parentId"))[0];var aJ=$.data(aL,"datagrid");var aI=aJ.options;if(aI.onBeforeSelectPage&&!aI.onBeforeSelectPage(aK,aH)){return}if(x(aL,aJ)){return}aI.pageNumber=aK;aI.pageSize=aH;aI.sizeChange=$.data(this,"pagination").options.sizeChange;$(this).pagination("refresh",{pageNumber:aK,pageSize:aH});d(aL,undefined,aJ)}});az.pageSize=ax.pagination("options").pageSize}function an(aJ){var aH=aJ.options;var aM;var aK=[];aH.searchFieldNames=undefined;if(!aH.searchFields){aM=undefined}else{if(aH.searchFields=="auto"){aM=[{field:"-",title:"任意字段"}];aI(aM,aH.frozenColumns);aI(aM,aH.columns,aK);aH.searchFields=aM}else{aM=aH.searchFields}}if(aM){var aP=[];for(var aL=0,aN=aM.length;aL<aN;aL++){if(aM[aL].field!="-"){aP.push(aM[aL].field)}}aH.searchFieldNames=aP.join(",")}if(aK.length>0){var aO=[];for(var aL=0,aN=aK.length;aL<aN;aL++){if(aK[aL].field!="-"){aO.push(aK[aL].field)}}aH.firstNameSearchFieldNames=aO.join(",")}function aI(aV,aR,aT){if(aR){for(var aU=0,aW=aR.length;aU<aW;aU++){var aQ=aR[aU];for(var aS=0,aY=aQ.length;aS<aY;aS++){var aX=aQ[aS];if(aX.field&&!aX.checkbox&&aX.canSearch==undefined){if(aX.firstNameSearch==undefined){aV.push({field:aX.field,title:aX.title})}else{aT.push({field:aX.field,title:aX.title})}}}}}return null}}function aA(aM,aJ,aL){var aK=aL.options;var aH=aK.searchFields;var aI=$('<input type="text" class="datagrid-search searchbox-prompt" value="在这里输入您要搜索的内容">').appendTo(aJ).unbind(".datagrid").bind("input.datagrid propertychange.datagrid",function(aO){var aN=this.value;if($(this).is(".searchbox-prompt")){aN=""}F(aM,aN,"-",null)}).bind("blur.datagrid",function(){if(this.value==""){this.value="在这里输入您要搜索的内容";$(this).addClass("searchbox-prompt")}}).bind("focus.datagrid",function(){if($(this).is(".searchbox-prompt")){this.value="";$(this).removeClass("searchbox-prompt")}})}function av(aI,aM,aH,aP){if(!aI){return}if((!aM||aM.length==0)&&(!aH||!az.rownumbers)){return}if(!aM){aM=[]}var aV=$(aI);aV.show();aV.empty();var aW=$('<table class="datagrid-htable" border="0" cellspacing="0" cellpadding="0"><tbody></tbody></table>').appendTo(aI);var aL;for(var aO=0,aJ=aM.length;aO<aJ;aO++){var aR=$('<tr class="datagrid-header-row"></tr>').appendTo($("tbody",aW));var aS=aM[aO];for(var aN=0,aU=aS.length;aN<aU;aN++){var aK=aS[aN];aK.index=++aP;var aQ="";if(aK.rowspan){aQ+='rowspan="'+aK.rowspan+'" '}if(aK.colspan){aQ+='colspan="'+aK.colspan+'" '}aL=$("<td "+aQ+"></td>").appendTo(aR);if(aK.checkbox){aL.attr("field",aK.field);$('<div class="datagrid-header-check"><input type="checkbox"/></div>').appendTo(aL)}else{if(aK.field){aL.attr("field",aK.field);var aT=$('<div class="datagrid-cell"><span>'+aK.title+'</span><span class="datagrid-sort-icon">&nbsp;</span></div>').appendTo(aL);if(aK.resizable==false){aT.attr("resizable","false")}if(aK.width){aT._outerWidth(aK.width);aK.boxWidth=parseInt(aT[0].style.width)}else{aK.auto=true}aT.css("text-align","center");aK.cellClass="datagrid-cell-c"+r+"-"+aK.field.replace(".","-");aK.cellSelector="div."+aK.cellClass}else{$('<div class="datagrid-cell-group">'+aK.title+"</div>").appendTo(aL)}}if(aK.hidden){aL.hide()}}}if(aH&&az.rownumbers){aL=$('<td rowspan="'+aM.length+'"><div class="datagrid-header-rownumber"></div></td>');if($("tr",aW).length==0){aL.wrap('<tr class="datagrid-header-row"></tr>').parent().appendTo($("tbody",aW))}else{aL.prependTo($("tr:first",aW))}}}function aw(aO,aN){var aJ=aN.dc;aJ.view.children("style").remove();var aM=['<style type="text/css">'];var aI=i(aO,true,aN).concat(i(aO),aN);for(var aL=0,aH=aI.length;aL<aH;aL++){var aK=U(aO,aI[aL],aN);if(aK&&!aK.checkbox){aM.push(aK.cellSelector+" {width:"+aK.boxWidth+"px;}")}}aM.push("</style>");$(aM.join("\n")).prependTo(aJ.view)}}function F(at,ar,an,ao){var aq=$.data(at,"datagrid");var ap=aq.options;if(!ap.onSearch){return}if(!an||an==""||an=="-"){an=ap.searchFieldNames}if(!ao||ao==""||ao=="-"){ao=ap.firstNameSearchFieldNames}if(aq.search){aq.search.searchbox("setValue",ar)}ap.onSearch.call(at,ar,an,ao)}function ai(au,ao){if(!ao){ao=$.data(au,"datagrid")}var an=ao.options;var av=ao.dc;var ar;ar=av.header2.add(av.header1);ar.find("td:has(div.datagrid-cell)").unbind(".datagrid").bind("mouseenter.datagrid",{target:au},function(aE){var aD=aE.data.target;var ay=$.data(aD,"datagrid");var ax=ay.options;var aC=$(this);if(ax.canHideColumn){var aB=ay.dc.hideColBtn;var aA=aC.offset().left;var az=aC.offset().top;aA+=aC._outerWidth()-aB._outerWidth()-5;az+=Math.floor((aC._outerHeight()-aB._outerHeight())/2);aB.css({left:aA,top:az,zIndex:$.fn.window.defaults.zIndex++,display:"block"})}aC.addClass("datagrid-header-over")}).bind("mouseleave.datagrid",{target:au},function(ax){$(this).removeClass("datagrid-header-over")}).bind("contextmenu.datagrid",{target:au},function(aB){var aA=aB.data.target;var ay=$.data(aA,"datagrid");var ax=ay.options;var az=$(this).attr("field");ax.onHeaderContextMenu.call(aA,aB,az)});ar.find("input[type=checkbox]").unbind(".datagrid").bind("click.datagrid",{target:au},function(aA){var az=aA.data.target;var ay=$.data(az,"datagrid");var ax=ay.options;if(ax.singleSelect&&ax.selectOnCheck){return false}if($(this).is(":checked")){c(az,undefined,ay)}else{s(az,undefined,ay)}aA.stopPropagation()});var aw=ar.find("div.datagrid-cell");aw.unbind(".datagrid").bind("click.datagrid",{target:au},function(aC){var aF=$(this),aD=aC.data.target;if(aC.pageX<aF.offset().left+aF._outerWidth()-5){var aG=$.data(aD,"datagrid");var ax=aG.options;if(x(aD,aG)){return}var aA=$(this).parent().attr("field");var ay=U(aD,aA,aG);if(!ay.sortable||aG.resizing){return}ax.sortName=ax.sortName||[];ax.sortOrder=ax.sortOrder||[];var aB=indexOfArray(ax.sortName,aA);var az=0;if(aB==-1){az=ax.sortName.length}else{az=aB}ax.sortName[az]=aA;ax.sortOrder[az]="asc";var aE="datagrid-sort-asc";if($(this).hasClass(aE)){aE="datagrid-sort-desc";ax.sortOrder[az]="desc"}if(!aC.ctrlKey){aw.removeClass("datagrid-sort-asc datagrid-sort-desc");if(az==0){aw.each(function(){$(this).find("span.eap_span").remove();$(this).removeClass("datagrid-sort-asc datagrid-sort-desc")})}$(this).addClass(aE);if(ax.doSortColumn){ax.doSortColumn.call(aD,ax.sortName,ax.sortOrder)}else{if(ax.remoteSort){d(aD,undefined,aG)}else{t(aD,aG.data,aG)}if(ax.onSortColumn){ax.onSortColumn.call(aD,ax.sortName,ax.sortOrder)}}}else{if(az==0){aw.each(function(){$(this).find("span.eap_span").remove();$(this).removeClass("datagrid-sort-asc datagrid-sort-desc")})}if(!$(this).has("span.eap_span").length){$("<span class='eap_span'>"+ax.sortNumber[az]+"</span>").appendTo($(this))}$(this).removeClass("datagrid-sort-asc datagrid-sort-desc");$(this).addClass(aE)}}}).bind("dblclick.datagrid",{target:au},function(aB){var aA=$(this),az=aB.data.target;if(aB.pageX>aA.offset().left+$(this)._outerWidth()-5){var ay=aA.parent().attr("field");var ax=U(az,ay);if(ax.resizable==false){return}Q(az,ay);ax.auto=false}});$(document).unbind(".datagrid").bind("keyup.datagrid",{target:au},function(az){if(az.keyCode==17){au=az.data.target;var ax=$.data(au,"datagrid");var ay=ax.options;if(ay.sortName&&ay.sortName.length){if(ay.doSortColumn){ay.doSortColumn.call(au,ay.sortName,ay.sortOrder)}else{if(ay.remoteSort){d(au,undefined,ax)}else{t(au,ax.data,ax)}if(ay.onSortColumn){ay.onSortColumn.call(au,ay.sortName,ay.sortOrder)}}}}}).bind("click.datarid",function(ax){if(an.canHideColumn){$("div.hide-column-fields").hide()}});var aq=$(au).attr("id");aw.each(function(){var ax=$(this);ax.resizable({handles:"e",disabled:ax.attr("resizable")=="false",minWidth:25,onStartResize:function(aC){var aB=$("#"+aq)[0];var aA=$.data(aB,"datagrid");var az=aA.panel;var ay=aA.dc;var aD=ay.header2.add(ay.header1);aA.resizing=true;aD.css("cursor","e-resize");if(!aA.proxy){aA.proxy=$('<div class="datagrid-resize-proxy"></div>').appendTo(ay.view)}aA.proxy.css({left:aC.pageX-$(az).offset().left-1,display:"none"});if(aA.proxy){setTimeout(aA.proxy.show,500)}},onResize:function(aB){var aA=$("#"+aq)[0];var az=$.data(aA,"datagrid");var ay=az.panel;az.proxy.css({left:aB.pageX-$(ay).offset().left-1,display:"block"});return false},onStopResize:function(){var aD=$("#"+aq)[0];var aB=$.data(aD,"datagrid");var aA=aB.options;var ay=aB.dc;var aE=ay.header2.add(ay.header1);aE.css("cursor","");var aC=$(this).parent().attr("field");var az=U(aD,aC,aB);az.width=$(this)._outerWidth();az.boxWidth=parseInt(this.style.width);az.auto=undefined;L(aD,aC,aB);ay.view2.children("div.datagrid-header").scrollLeft(ay.body2.scrollLeft());aB.proxy.remove();aB.proxy=null;if($(this).parents("div:first.datagrid-header").parent().hasClass("datagrid-view1")){J(aD,aB)}o(aD,aB);aA.onResizeColumn.call(aD,aC,az.width);aB.resizing=false}})});var at;at=av.body1.add(av.body2);at.unbind().bind("mouseover",{target:au},function(aC){var aA=$(aC.target).closest("tr.datagrid-row");if(!aA.length){return}var ax=ap(aA);var aB=aC.data.target;var az=$.data(aB,"datagrid");var ay=az.options;ay.finder.getTr(aB,ax,undefined,undefined,az).addClass("datagrid-row-over");aC.stopPropagation()}).bind("mouseout",{target:au},function(aC){var aA=$(aC.target).closest("tr.datagrid-row");if(!aA.length){return}var ax=ap(aA);var aB=aC.data.target;var az=$.data(aB,"datagrid");var ay=az.options;ay.finder.getTr(aB,ax,undefined,undefined,az).removeClass("datagrid-row-over");aC.stopPropagation()}).bind("click",{target:au},function(aB){var aD=$(aB.target);var aE=aD.closest("tr.datagrid-row");if(!aE.length){return}var aA=ap(aE);var aC=aB.data.target;var ay=$.data(aC,"datagrid");var ax=ay.options;if(aD.parent().hasClass("datagrid-cell-check")){if(ax.singleSelect&&ax.selectOnCheck){if(!ax.checkOnSelect){s(aC,true,ay)}al(aC,aA,undefined,ay)}else{if(aD.is(":checked")){al(aC,aA,undefined,ay)}else{k(aC,aA,undefined,ay)}}}else{var aG=ax.finder.getRow(aC,aA,ay);var az=aD.closest("td[field]",aE);if(az.length){var aF=az.attr("field");ax.onClickCell.call(aC,aA,aF,aG[aF])}if(ax.singleSelect==true){aa(aC,aA,undefined,ay)}else{if(ax.finder.getTr(aC,aA,undefined,undefined,ay).hasClass("datagrid-row-selected")){S(aC,aA,undefined,ay)}else{aa(aC,aA,undefined,ay)}}ax.onClickRow.call(aC,aA,aG,aB)}aB.stopPropagation()}).bind("dblclick",{target:au},function(aB){var aD=$(aB.target);var aE=aD.closest("tr.datagrid-row");if(!aE.length){return}var aA=ap(aE);var aC=aB.data.target;var ay=$.data(aC,"datagrid");var ax=ay.options;var aG=ax.finder.getRow(aC,aA,ay);var az=aD.closest("td[field]",aE);if(az.length){var aF=az.attr("field");ax.onDblClickCell.call(aC,aA,aF,aG[aF])}ax.onDblClickRow.call(aC,aA,aG);aB.stopPropagation()}).bind("contextmenu",{target:au},function(aC){var aA=$(aC.target).closest("tr.datagrid-row");if(!aA.length){return}var ax=ap(aA);var aB=aC.data.target;var az=$.data(aB,"datagrid");var ay=az.options;var aD=ay.finder.getRow(aB,ax,az);ay.onRowContextMenu.call(aB,aC,ax,aD);aC.stopPropagation()});av.body2.bind("scroll",{target:au},function(aA){var az=aA.data.target;var ay=$.data(az,"datagrid");var ax=ay.dc;ax.view1.children("div.datagrid-body").scrollTop($(this).scrollTop());if(ay.editing.index!=undefined){b(ay)}ax.view2.children("div.datagrid-header,div.datagrid-footer").scrollLeft($(this).scrollLeft())});function ap(ax){if(ax.attr("datagrid-row-index")){return parseInt(ax.attr("datagrid-row-index"))}else{return ax.attr("node-id")}}if(!an.canHideColumn){return}av.hideColBtn.unbind(".datagrid").bind("click.datagrid",{target:au},function(aB){var aC=aB.data.target;var ax=$.data(aC,"datagrid");var aG=ax.dc;var ay=$(this);var aF=aG.hideColFields;var aA=ay.offset();var az=aA.left;var aD=aA.top;var aE=aF._outerWidth();if(az+aE>document.body.clientWidth-5){az=document.body.clientWidth-aE-5}aD+=ay._outerHeight();aF.css({left:az,top:aD,zIndex:$.fn.window.defaults.zIndex++}).show();aB.stopPropagation()});$("div.hide-column-fields").bind("mouseleave",function(ax){$("div.hide-column-button").hide();$(this).hide()});$("div.hide-column-fields input[type=checkbox]").bind("click",function(aI){var az=$.data(au,"datagrid");var ay=az.panel;$("div.hide-column-button").hide();var aB=$(this).prop("checked");var aA=ay.find('td[field="'+this.value+'"]');if(!aB){aA.hide()}else{aA.show()}var aC=U(au,this.value,az);if(aC){aC.hidden=!aB;var ax=az.options;var aG=ax.columns;var aL=true;for(var aF=0,aH=aG.length;aF<aH;aF++){var aD=aG[aF];for(var aE=0,aK=aD.length;aE<aK;aE++){var aJ=aD[aE];if(aJ.hidden==undefined||!aJ.hidden){aL=false;break}}}if(!aL){$(".datagrid-view1 .datagrid-body").css("overflow-y","hidden");o(au,az)}else{$(".datagrid-view1 .datagrid-body").css("overflow-y","auto")}}aI.stopPropagation()})}$(window).resize(function(){$("div.hide-column-fields").hide();$("div.hide-column-button").hide()});function b(ar){var an=ar.dc;var at=an.editor2.position();var ap=an.header2._outerHeight();var ao=at.top+ap+an.editor2._outerHeight();var aq=an.editorTool._outerHeight();if(an.view.height()-ao>=aq){an.editorTool.css("top",ao)}else{an.editorTool.css("top",at.top+ap-aq)}}function Q(ax,ay){var ap=$.data(ax,"datagrid");var an=ap.options;if(ay){at(ax,ap,ay);if(an.fitColumns){J(ax,ap);o(ax,ap)}}else{var ao=false;var au=i(ax,true,ap).concat(i(ax,false,ap));for(var ar=0,aw=au.length;ar<aw;ar++){var av=au[ar];var aq=U(ax,av,ap);if(aq.auto){at(ax,ap,av);ao=true}}if(ao&&an.fitColumns){J(ax,ap);o(ax,ap)}}function at(aE,aA,aG){$("div.hide-column-fields").hide();$("div.hide-column-button").hide();var az=aA.options;var aH=aA.dc;var aD=aH.view.find('div.datagrid-header td[field="'+aG+'"] div.datagrid-cell');aD.css("width","");var aC=U(aE,aG,aA);aC.width=undefined;aC.boxWidth=undefined;aC.auto=true;L(aE,aG,aA);var aB=Math.max(aD._outerWidth(),aF(az,"allbody"),aF(az,"allfooter"));aD._outerWidth(aB);aC.width=aB;aC.boxWidth=parseInt(aD[0].style.width);L(aE,aG,aA);az.onResizeColumn.call(aE,aG,aC.width);function aF(aK,aJ){var aI=0;aK.finder.getTr(aE,0,aJ,undefined,aA).find('td[field="'+aG+'"] div.datagrid-cell').each(function(){var aL=$(this)._outerWidth();if(aI<aL){aI=aL}});return aI}}}function o(aA,ao){if(!ao){ao=$.data(aA,"datagrid")}var an=ao.options;var aC=ao.dc;if(!an.fitColumns){return}var av=aC.view2.children("div.datagrid-header");var ay=0;var aE,aq,au,ax;var aw=i(aA,false,ao);for(au=0,ax=aw.length;au<ax;au++){aq=U(aA,aw[au],ao);if(ar(aq)){ay+=aq.width;aE=aq}}var aB=av.children("div.datagrid-header-inner").show();var at=av.width()-av.find("table").width()-an.scrollbarSize;var az=at/ay;if(!an.showHeader){aB.hide()}for(au=0,ax=aw.length;au<ax;au++){aq=U(aA,aw[au],ao);if(ar(aq)){var ap=Math.floor(aq.width*az);aD(av,aq,ap);at-=ap}}if(at&&aE){aD(av,aE,at)}L(aA,undefined,ao);function ar(aF){if(!aF.hidden&&!aF.checkbox&&!aF.auto){return true}}function aD(aH,aF,aG){aF.width+=aG;aF.boxWidth+=aG;aH.find('td[field="'+aF.field+'"] div.datagrid-cell').width(aF.boxWidth)}}function L(at,au,an){if(!an){an=$.data(at,"datagrid")}var av=an.dc;var aw=av.view.find("table.datagrid-btable,table.datagrid-ftable");aw.css("table-layout","fixed");if(au){aq(at,an,au)}else{var ao=i(at,true,an).concat(i(at,false,an));for(var ar=0;ar<ao.length;ar++){aq(at,an,ao[ar])}}aw.css("table-layout","auto");D(at,an);var ap=$(at).attr("id");setTimeout(function(){var ay=$("#"+ap)[0];var ax=$.data(ay,"datagrid");l(ay,undefined,undefined,ax);h(ay,ax)},0);function aq(aC,ax,aE){var aH=ax.dc;var az=U(aC,aE,ax);if(az.checkbox){return}var ay=aH.view.children("style")[0];var aF=ay.styleSheet?ay.styleSheet:(ay.sheet||document.styleSheets[document.styleSheets.length-1]);var aG=aF.cssRules||aF.rules;for(var aA=0,aB=aG.length;aA<aB;aA++){var aD=aG[aA];if(aD.selectorText.toLowerCase()==az.cellSelector.toLowerCase()){aD.style.width=az.boxWidth?az.boxWidth+"px":"auto";break}}}}function G(ar,au){var aq=$.data(ar,"datagrid");var ao=aq.dc;var av=ao.view1.children("div.datagrid-header").add(ao.view2.children("div.datagrid-header"));var at;if(!au.length){au=[au]}for(var ap=0,an=au.length;ap<an;ap++){at=au[ap];av.find("td[field="+at.field+"] div.datagrid-cell span").eq(0).text(at.title)}}function D(aq,ap){if(!ap){ap=$.data(aq,"datagrid")}var ao=ap.dc;var an=ao.body1.add(ao.body2);an.find("td.datagrid-td-merged").each(function(av,au){var ax=$(this);var aw=ax.attr("colspan")||1;var at=U(av,ax.attr("field"),au).width;for(var ar=1;ar<aw;ar++){ax=ax.next();at+=U(av,ax.attr("field"),au).width+1}ax.children("div.datagrid-cell")._outerWidth(at)},[aq,ap])}function h(ap,ao){if(!ao){ao=$.data(ap,"datagrid")}var an=ao.dc;an.view.find("div.datagrid-editable").each(function(av){var aq=$(this);var au=aq.parent().attr("field");var at=U(av,au);aq._outerWidth(at.width);var ar=$.data(this,"datagrid.editor");if(ar.actions.resize){ar.actions.resize(ar.target,aq.width())}},[ap])}function U(ar,aq,ap){if(!aq){return undefined}function at(ax){if(ax){for(var aw=0,au=ax.length;aw<au;aw++){var aA=ax[aw];for(var av=0,az=aA.length;av<az;av++){var ay=aA[av];if(ay.field==aq){return ay}}}}return null}if(!ap){ap=$.data(ar,"datagrid")}var ao=ap.options;var an=at(ao.columns);if(!an){an=at(ao.frozenColumns)}return an}function i(aw,an,aq){if(!aq){aq=$.data(aw,"datagrid")}var ao=aq.options;var ar=(an==true)?(ao.frozenColumns||[[]]):ao.columns;if(ar.length==0){return[]}var au=[];function ax(ay,aA){var aB=0;var az=0;while(true){if(ay[az]==undefined){if(aB==aA){return az}aB++}az++}}function ap(aC,aD){var az=[];var aF=0;var aB,ay;for(aB=0,ay=aC[aD].length;aB<ay;aB++){var aA=aC[aD][aB];if(aA.field){az.push([aF,aA.field])}aF+=parseInt(aA.colspan||"1")}for(aB=0,ay=az.length;aB<ay;aB++){az[aB][0]=ax(au,az[aB][0])}for(aB=0,ay=az.length;aB<ay;aB++){var aE=az[aB];au[aE[0]]=aE[1]}}for(var at=0,av=ar.length;at<av;at++){ap(ar,at)}return au}function t(au,at,ao){if(!ao){ao=$.data(au,"datagrid")}var an=ao.options;var av=ao.dc;var ar=ao.selectedRows;at=an.loadFilter.call(au,at);ao.data=at;if(at.footer){ao.footer=at.footer}if(an.onBeforeBind){an.onBeforeBind.call(au,at)}if(!an.remoteSort){var ap=U(au,an.sortName,ao);if(ap){var aw=ap.sorter||function(ay,ax){ay=ay+"";ax=ax+"";if(ap.number){ay=ay.toDouble();ax=ax.toDouble();return(ay>ax?1:-1)}return ay.localeCompare(ax)};at.rows.sort(function(ay,ax){return aw(ay[an.sortName],ax[an.sortName])*(an.sortOrder=="asc"?1:-1)})}}if(an.view.onBeforeRender){an.view.onBeforeRender.call(an.view,au,at.rows,ao)}an.view.render.call(an.view,au,av.body2,false,ao);an.view.render.call(an.view,au,av.body1,true,ao);if(an.showFooter){an.view.renderFooter.call(an.view,au,av.footer2,false,ao);an.view.renderFooter.call(an.view,au,av.footer1,true,ao)}if(an.view.onAfterRender){an.view.onAfterRender.call(an.view,au,ao)}an.total=at.total;var aq=a(au,ao);if(aq.length){if(aq.pagination("options").total!=at.total){aq.pagination("refresh",{total:at.total})}if(aq.pagination("options").pageNumber!=at.pageNumber){aq.pagination("refresh",{pageNumber:at.pageNumber})}}l(au,undefined,undefined,ao);av.body2.triggerHandler("scroll");ar.splice(0,ar.length);an.onLoadSuccess.call(au,at);Q(au)}function X(aq,ar,ap){if(!ap){ap=$.data(aq,"datagrid")}var an=ap.options;var ao=ap.data.rows;if(typeof ar=="object"){return indexOfArray(ao,ar)}else{return indexOfRowId(ao,an.idField,ar)}}function T(ar,aq){if(!aq){aq=$.data(ar,"datagrid")}var an=aq.options;var ap=aq.data;if(an.idField){return aq.selectedRows}else{var ao=[];an.finder.getTr(ar,"","selected",2,aq).each(function(au){var at=parseInt($(this).attr("datagrid-row-index"));au.push(ap.rows[at])},[ao]);return ao}}function R(ar,an,aq){if(!aq){aq=$.data(ar,"datagrid")}var ap=aq.options;if(ap.idField){var ao=X(ar,an,aq);if(ao>=0){aa(ar,ao,undefined,aq)}}}function aa(av,au,az,ao){if(!ao){ao=$.data(av,"datagrid")}var ay=ao.dc;var an=ao.options;var at=ao.data;var aq=$.data(av,"datagrid").selectedRows;var aw=an.finder.getTr(av,au,undefined,undefined,ao);if(aw.hasClass("cannot-select")){return}if(an.singleSelect){Z(av,undefined,ao);aq.splice(0,aq.length)}if(!az&&an.checkOnSelect){al(av,au,true,ao)}if(an.idField){var aB=an.finder.getRow(av,au,ao);if(!aB[an.idField]||indexOfRowId(aq,an.idField,aB[an.idField])<0){aq.push(aB)}}an.onSelect.call(av,au,at.rows[au]);aw.addClass("datagrid-row-selected");if(aw.length){var aA=ay.body2;var ax=aw.position().top;if(ax<=0){aA.scrollTop(aA.scrollTop()+ax)}else{var ap=aw._outerHeight(),ar=aA[0].clientHeight;if(ax+ap>ar){aA.scrollTop(aA.scrollTop()+ax+ap-ar)}}}}function S(at,ao,an,aq){if(!aq){aq=$.data(at,"datagrid")}var ap=aq.options;var ar=aq.selectedRows;if(!an&&ap.checkOnSelect){k(at,ao,true,aq)}ap.finder.getTr(at,ao,undefined,undefined,aq).removeClass("datagrid-row-selected");var au=ap.finder.getRow(at,ao,aq);if(ap.idField){if(au[ap.idField]){removeArrayItem(ar,ap.idField,au[ap.idField])}else{removeArrayItem(ar,au)}}ap.onUnselect.call(at,ao,au)}function ag(au,av,ao){if(!ao){ao=$.data(au,"datagrid")}var an=ao.options;var ax=ao.data.rows;ao.selectedRows=[];var ap=ao.selectedRows;if(!av&&an.checkOnSelect){c(au,true,ao)}an.finder.getTr(au,"","allbody",undefined,ao).not($(".cannot-select")).addClass("datagrid-row-selected");if(an.idField){var aq={};for(var at=0,ar=ax.length;at<ar;at++){if(an.finder.getTr(au,at,undefined,undefined,ao).hasClass("cannot-select")){continue}var aw=ax[at];if(aw[an.idField]){if(!aq[aw[an.idField]]){ap.push(aw);aq[aw[an.idField]]=1}}else{ap.push(aw)}}}an.onSelectAll.call(au,ax)}function Z(at,an,aq){if(!aq){aq=$.data(at,"datagrid")}var ao=aq.options;var ap=aq.data.rows;var ar=aq.selectedRows;if(!an&&ao.checkOnSelect){s(at,true,aq)}ao.finder.getTr(at,"","selected",undefined,aq).removeClass("datagrid-row-selected");ar.splice(0,ar.length);ao.onUnselectAll.call(at,ap)}function al(au,at,ar,ao){if(!ao){ao=$.data(au,"datagrid")}var an=ao.options;var ap=ao.data;if(!ar&&an.selectOnCheck){aa(au,at,true,ao)}var aw;if(ar){aw=an.finder.getTr(au,at,undefined,undefined,ao).find("div.datagrid-cell-check input[type=checkbox]")}else{aw=an.finder.getTr(au,at,undefined,undefined,ao).find("div.datagrid-cell-check input:enabled[type=checkbox]")}if(aw.length){$.fn.prop?aw.prop("checked",true):aw.attr("checked",true);var av=an.finder.getTr(au,"","allbody",undefined,ao).add(an.finder.getTr(au,"","editor",undefined,ao)).find("div.datagrid-cell-check input:enabled[type=checkbox]:visible:not(:checked)");if(av&&av.length==0){var aq=ao.dc.header1.add(ao.dc.header2).find(">table>tbody>tr>td div.datagrid-header-check input:enabled[type=checkbox]:not(:checked)");if(aq.length){$.fn.prop?aq.prop("checked",true):aq.attr("checked",true)}}an.onCheck.call(au,at,ap.rows[at])}}function k(av,ap,an,au){if(!au){au=$.data(av,"datagrid")}var ar=au.options;var at=au.data;if(!an&&ar.selectOnCheck){S(av,ap,true,au)}var ao;if(an){ao=ar.finder.getTr(av,ap,undefined,undefined,au).find("div.datagrid-cell-check input[type=checkbox]")}else{ao=ar.finder.getTr(av,ap,undefined,undefined,au).find("div.datagrid-cell-check input:enabled[type=checkbox]")}if(ao.length){$.fn.prop?ao.prop("checked",false):ao.attr("checked",false);var aq=au.dc.header1.add(au.dc.header2).find(">table>tbody>tr>td div.datagrid-header-check input:enabled[type=checkbox]:checked");if(aq.length){$.fn.prop?aq.prop("checked",false):aq.attr("checked",false)}ar.onUncheck.call(av,ap,at.rows[ap])}}function y(an){var ao=an.parents("table.datagrid-btable").next("div.datagrid-editor");ao.find("input[type=checkbox]").prop("checked",an.prop("checked"))}function c(at,an,ar){if(!ar){ar=$.data(at,"datagrid")}var ap=ar.options;var aq=ar.data;if(!an&&ap.selectOnCheck){ag(at,true,ar)}var ao=ap.finder.getTr(at,"","allbody",undefined,ar).add(ap.finder.getTr(at,"","editor",undefined,ar)).find("div.datagrid-cell-check input:enabled[type=checkbox]");$.fn.prop?ao.prop("checked",true):ao.attr("checked",true);ap.onCheckAll.call(at,aq.rows)}function s(at,an,ar){if(!ar){ar=$.data(at,"datagrid")}var ap=ar.options;var aq=ar.data;if(!an&&ap.selectOnCheck){Z(at,true,ar)}var ao=ap.finder.getTr(at,"","allbody",undefined,ar).add(ap.finder.getTr(at,"","editor",undefined,ar)).find("div.datagrid-cell-check input:enabled[type=checkbox]");$.fn.prop?ao.prop("checked",false):ao.attr("checked",false);ap.onUncheckAll.call(at,aq.rows)}function z(aq,an){var ap=$.data(aq,"datagrid");var ao=ap.options;if(ao.readonly){alert("请设置readonly属性。");return}if(x(aq,ap)){return}var ar=ao.finder.getRow(aq,an,ap);if(ao.onBeforeEdit.call(aq,an,ar)==false){return}v(aq,an,ar,ap);ak(aq,ap)}function w(ap,ao){var an=$.data(ap,"datagrid").options;an.onEditorBtnClick.call(ap,!ao)}function ah(au,aA,ao,at){if(!ao){ao=$.data(au,"datagrid")}if(!x(au,ao)){return}var an=ao.options;var ax=ao.updatedRows;var ap=ao.insertedRows;var aw=an.finder.getTr(au,0,"editor",undefined,ao),ar=ao.editing.index,av=ao.editing.insertedIndex;var aB=an.finder.getRow(au,ar,ao);if(!aA){if(!ak(au)){return}var aq=false;var ay={oldValue:{},newValue:{}};aw.find("div.datagrid-editable").each(function(){var aE=$(this).parent().attr("field");var aC=$.data(this,"datagrid.editor");var aD=aC.actions.getValue(aC.target);if(aB[aE]!=aD){aq=true;ay[aE]=aD;ay.oldValue[aE]=aB[aE];ay.newValue[aE]=aD;aB[aE]=aD}});if(aq){if(indexOfArray(ap,aB)==-1&&indexOfArray(ax,aB)==-1){ax.push(aB)}}}var az=ao.dc;az.editor2.add(az.editor1).add(az.editorTool).hide();ao.editing.index=undefined;ao.editing.insertedIndex=undefined;if(!aA){an.onAfterEdit.call(au,ar,aB,ay)}else{an.onCancelEdit.call(au,ar,aB)}an.onEndEdit.call(au,ar,aB);if(!aA){an.view.refreshRow.call(an.view,au,ar,ao)}else{if(av==ar&&!at){M(au,ar,ao)}}if(an.onAfterEndEdit){an.onAfterEndEdit.call(au,aB,ar)}}function x(ao,an){if(!an){an=$.data(ao,"datagrid")}return an.editing.index!=undefined}function ad(ar){var aq=$.data(ar,"datagrid");var ao=aq.options;var ap=ao.finder.getTr(ar,0,"editor",undefined,aq);var an=[];ap.children("td").each(function(av){var at=$(this).find("div.datagrid-editable");if(at.length){var au=$.data(at[0],"datagrid.editor");av.push(au)}},[an]);return an}function H(at,ar){var aq=$.data(at,"datagrid");var ao=aq.options;var ap=ao.finder.getTr(at,0,"editor",undefined,aq);var an=ap.children('td[field="'+ar+'"]').find("div.datagrid-editable");if(an.length){return $.data(an[0],"datagrid.editor")}return null}function j(az,at,ao){if(!ao){ao=$.data(az,"datagrid")}var an=ao.options;if(!at.length){at=[at]}var aw,ay,ar,aq;for(aw=0,ay=at.length;aw<ay;aw++){aq=at[aw];ar=U(az,aq.field,ao);if(!ar){continue}ar.editor=aq.editor}if(!ao.editing.rendered){return}var ax,aC;if(x(az,ao)){ax=ao.editing.index;aC=ao.data.rows[ax]}else{ax=0;aC={}}var aB=an.finder.getTr(az,ax,undefined,undefined,ao);var aA=an.finder.getTr(az,ax,"editor",undefined,ao),ap;for(var au=0,av=at.length;au<av;au++){aq=at[au];ap=aA.children('td[field="'+aq.field+'"]');if(ap.length>0){e(ap);B(az,ap,ao,aC[aq.field],aB.find('td[field="'+aq.field+'"] > div'))}}f(az,ao)}function v(at,ar,az,ao){if(!ao){ao=$.data(at,"datagrid")}var ax=ao.dc;var an=ao.options;ao.editing.index=ar;var au=an.finder.getTr(at,ar,undefined,undefined,ao),aq;if(!ao.editing.rendered){an.view.renderEditor.call(an.view,at,ax.editor2,false,ao);an.view.renderEditor.call(an.view,at,ax.editor1,true,ao);aq=an.finder.getTr(at,ar,"editor",undefined,ao);an.view.attrRowIndex(aq,ar);aq.children("td").each(function(aG,aE,aH,aD){var aB=$(this);var aF=aB.attr("field");if(aF){var aA=aw(aE,aF);B(aG,aB,aD,aH[aF],aA)}else{var aC=aE.find("td.datagrid-td-rownumber > div").html();ab(aB,aC)}},[at,au,az,ao]);f(at,ao);ao.editing.rendered=true}else{aq=an.finder.getTr(at,ar,"editor",undefined,ao);an.view.attrRowIndex(aq,ar);aq.children("td").each(function(aD,aF){var aB=$(this);var aE=aB.attr("field");if(aE){var aA=aw(aD,aE);ab(aB,aF[aE],aA)}else{var aC=aD.find("td.datagrid-td-rownumber > div").html();ab(aB,aC)}},[au,az])}var av=an.finder.getTr(at,0,"editor",undefined,ao);var ay=an.rowStyler?an.rowStyler.call(at,ar,az):"";av.attr("style",ay||"").css("height",au.css("height"));var ap=$(at).attr("id");setTimeout(function(){var aE=$("#"+ap)[0];var aD=$.data(aE,"datagrid");var aA=aD.dc;var aB=aD.options;var aC=aB.finder.getTr(aE,ar,"body",2,aD);var aF=aC.position();aA.editor2.add(aA.editor1).css("top",aF.top+aA.body2.scrollTop()).show();aA.editorTool.show();b(aD);$.hotkeys.focusFirst(aD.dc.view[0])},100);function aw(aA,aB){return aA.find('td[field="'+aB+'"] > div')}}function ab(ar,aq,ao){var an=ar.find("div.datagrid-editable");if(an.length>0){var ap=$.data(an[0],"datagrid.editor");if(ao){ap.actions.setValue(ap.target,aq,ao.html())}if(ap.actions.resize){ap.actions.resize(ap.target,an.width())}}else{if(ao){ar.empty().append(ao.clone())}else{ar.children("div").html(aq)}}}function B(az,aq,ao,aD,au){if(!ao){ao=$.data(az,"datagrid")}var an=ao.options;var aC=aq.find("div.datagrid-cell");if(!aC.length){aC=aq.find("div.datagrid-cell-check")}var aA=aq.attr("field");var at=U(az,aA,ao),ay=false;if(at&&at.editor){var aB,ar;if(typeof at.editor=="string"){aB=at.editor}else{aB=at.editor.type;ar=at.editor.options}var ax=an.editors[aB];if(ax){var aw=aC.html();var ap=at.width;aC.addClass("datagrid-editable");aC._outerWidth(ap);aC.empty();var av={actions:ax,target:ax.init(aC,ar,at.index),field:aA,type:aB,oldHtml:aw};$.data(aC[0],"datagrid.editor",av);av.actions.setValue(av.target,aD,au.html());if(av.actions.resize){av.actions.resize(av.target,aC.width())}ay=true}}if(!ay){if(au){aC.parent().empty().append(au.clone())}else{aC.html(aD)}}}function e(ap){var an=ap.find("div.datagrid-editable");if(an.length){var ao=$.data(an[0],"datagrid.editor");if(ao.actions.destroy){ao.actions.destroy(ao.target)}an.html("");$.removeData(an[0],"datagrid.editor");an.removeClass("datagrid-editable");an.css("width","")}}function ak(aq,ap){if(!ap){ap=$.data(aq,"datagrid")}if(!x(aq,ap)){return}var ao=ap.options.finder.getTr(aq,ap.editing.index,"editor",undefined,ap);var an=ao.find(".validatebox-text");an.validatebox("validate");an.trigger("mouseleave");var ar=ao.find(".validatebox-invalid");return ar.length==0}function V(at,ao){var ar=$.data(at,"datagrid");var aq=ar.insertedRows;var an=ar.deletedRows;var au=ar.updatedRows;if(!ao){var ap=[];ap=ap.concat(aq);ap=ap.concat(an);ap=ap.concat(au);return ap}else{if(ao=="inserted"){return aq}else{if(ao=="deleted"){return an}else{if(ao=="updated"){return au}}}}return[]}function M(av,au,ao){if(!ao){ao=$.data(av,"datagrid")}if(ao.editing.index==au){ah(av,true,ao,true)}var an=ao.options;var ar=ao.data;var ap=ao.insertedRows;var at=ao.deletedRows;var aq=ao.selectedRows;var aw=ar.rows[au];if(indexOfArray(ap,aw)>=0){removeArrayItem(ap,aw)}else{at.push(aw)}if(ar.rows[au][an.idField]){removeArrayItem(aq,an.idField,ar.rows[au][an.idField])}else{removeArrayItem(aq,ar.rows[au])}an.view.deleteRow.call(an.view,av,au,ao);if(an.height=="auto"){l(av,undefined,undefined,ao)}ao.dc.editor2.add(ao.dc.editor1).add(ao.dc.editorTool).hide()}function q(aq,ar,ap){if(!ap){ap=$.data(aq,"datagrid")}var an=ap.options.view;var ao=ap.insertedRows;an.insertRow.call(an,aq,ar.index,ar.row,ap);ao.push(ar.row)}function C(aq,ar,ap){if(!ap){ap=$.data(aq,"datagrid")}var an=ap.options.view;var ao=ap.insertedRows;an.insertRow.call(an,aq,null,ar,ap);ao.push(ar)}function u(ap,ao){if(!ao){ao=$.data(ap,"datagrid")}if(ao.options.showEditorTool){var an=ao.dc;if(an){an.editor2.add(an.editor1).add(an.editorTool).hide()}}}function W(au,at){if(!at){at=$.data(au,"datagrid")}var ar=at.data;var aq=ar.rows;var ap=[];for(var ao=0,an=aq.length;ao<an;ao++){ap.push($.extend({},aq[ao]))}at.originalRows=ap;at.updatedRows=[];at.insertedRows=[];at.deletedRows=[]}function O(ao,an){if(!an){an=$.data(ao,"datagrid")}if(!x(ao,an)){return}if(ak(ao,an)){ah(ao,false,an);W(ao,an)}}function p(ay,ao){if(!ao){ao=$.data(ay,"datagrid")}if(!x(ay,ao)){return}var an=ao.options;var av=ao.originalRows;var ap=ao.insertedRows;var au=ao.deletedRows;var aq=ao.selectedRows;var at=ao.data;var ar,aw;ah(ay,true,ao);var ax=[];for(ar=0,aw=aq.length;ar<aw;ar++){ax.push(aq[ar][an.idField])}aq.splice(0,aq.length);at.total+=au.length-ap.length;at.rows=av;t(ay,at,ao);for(ar=0,aw=ax.length;ar<aw;ar++){R(ay,ax[ar],ao)}W(ay,ao)}function d(at,av,ar){if(!ar){ar=$.data(at,"datagrid")}var aq=ar.options;if(av){aq.queryParams=av}var au=aq.queryParams||{};if(aq.pagination){$.extend(au,{page:aq.pageNumber,rows:aq.pageSize,sizeChange:aq.sizeChange})}if(aq.sortName&&aq.sortName.length>0){$.extend(au,{sort:aq.sortName.join(","),order:aq.sortOrder.join(",")})}if(aq.onBeforeLoad.call(at,au)==false){return}var an=$(at);aj(at,ar);var ao=an.attr("id");setTimeout(function(){ap(ao);aq.sortName=[];aq.sortOrder=[]},0);function ap(ax){var aA=$("#"+ax)[0];var az=$.data(aA,"datagrid");var ay=az.options;var aw=ay.loader.call(aA,au,function(aB){setTimeout(function(){I($("#"+ax)[0])},0);var aC=$("#"+ax)[0];t(aC,aB);setTimeout(function(){W($("#"+ax)[0])},0)},function(){setTimeout(function(){I($("#"+ax)[0])},0);ay.onLoadError.apply($("#"+ax)[0],arguments)});if(aw==false){I(aA,az)}}}function g(av,ap){var ao=$.data(av,"datagrid");var an=ao.options;var az=ao.data.rows;ap.rowspan=ap.rowspan||1;ap.colspan=ap.colspan||1;if(ap.index<0||ap.index>=az.length){return}if(ap.rowspan==1&&ap.colspan==1){return}var ay=az[ap.index][ap.field];var aw=an.finder.getTr(av,ap.index,undefined,undefined,ao);var aq=aw.find('td[field="'+ap.field+'"]');aq.attr("rowspan",ap.rowspan).attr("colspan",ap.colspan);aq.addClass("datagrid-td-merged");var at,au;for(at=1,au=ap.colspan;at<au;at++){aq=aq.next();aq.hide();az[ap.index][aq.attr("field")]=ay}for(at=1,au=ap.rowspan;at<au;at++){aw=aw.next();aq=aw.find('td[field="'+ap.field+'"]').hide();az[ap.index+at][aq.attr("field")]=ay;for(var ar=1,ax=ap.colspan;ar<ax;ar++){aq=aq.next();aq.hide();az[ap.index+at][aq.attr("field")]=ay}}D(av,ao)}function A(ap){var an=$.data(ap,"datagrid").dc;var ao={};var aq=an.view1.children("div.datagrid-header").add(an.view2.children("div.datagrid-header"));aq.find("td[field]").each(function(){var ar=$(this);ao[ar.attr("field")]=ar.width()});return ao}function Y(ap){var an=$.data(ap,"datagrid").dc;var ao={};var aq=an.view1.children("div.datagrid-header").add(an.view2.children("div.datagrid-header"));aq.find("td[field]").each(function(){var ar=$(this);ao[ar.attr("field")]=ar.is(":hidden")});return ao}$.fn.datagrid=function(an,ao){if(typeof an=="string"){return $.fn.datagrid.methods[an](this,ao)}an=an||{};return this.each(function(){var ar=$.data(this,"datagrid");var aq;if(ar){aq=$.extend(ar.options,an);ar.options=aq}else{aq=$.extend({},$.extend({},$.fn.datagrid.defaults,{queryParams:{}}),$.fn.datagrid.parseOptions(this),an);$(this).css("width","").css("height","");var ap=N(this,aq);ar=$.data(this,"datagrid",{editing:{},options:aq,panel:ap.panel,dc:ap.dc,selectedRows:[],data:{total:0,rows:[]},originalRows:[],updatedRows:[],insertedRows:[],deletedRows:[]})}m(this,ar);P(this,undefined,ar);if(!an.initNotQuery){d(this,undefined,ar)}ai(this,ar)})};function K(ao,an){if(!an){return}if(an.click){ao.click(an.click)}if(an.change){ao.change(an.change)}}function f(aq,ap){$.hotkeys.parseContainElements(ap.dc.view[0]);if(ap.options.onLastColEnter){var ao=aq.id;var an=ap.dc.view[0].id;$.hotkeys.bindCallback("enterLast."+an,function(){var ar=$("#"+ao),av=ar[0];var au=$.data(av,"datagrid");if(au.editing.index==undefined){return}var at=au.editing.index;ah(av,false,au);if(au.editing.index!=undefined){return}au.options.onLastColEnter.call(av,at,at==au.data.rows.length-1);return false});$.hotkeys.bindCallback("enter."+an,function(au){var ar=$("#"+ao),at=ar[0];am(at,au.id);return false})}}function am(au,at){var an=$.data(au,"datagrid");var av=an.dc;var ap=$("#"+at);if(ap.length){var aw=av.body2;var aq=ap.position().left;if(aq<=0){aw.scrollLeft(aw.scrollLeft()+aq)}else{var ao=ap._outerWidth(),ar=aw[0].clientWidth;if(aq+ao>ar){aw.scrollLeft(aw.scrollLeft()+aq+ao-ar)}}}}function af(ar){var aq=$.data(ar,"datagrid");var ap=aq.data;var an=aq.dc,ao=aq.options;ap.total=ao.total;ao.view.render.call(ao.view,ar,an.body2,false,aq);ao.view.render.call(ao.view,ar,an.body1,true,aq)}function ac(au,ar){if(!ar){ar=$.data(au,"datagrid")}var at=ar.options;var aq=ar.panel.panel("options");var ao=$.extend(at,{width:aq.width,height:aq.height,closed:aq.closed,collapsed:aq.collapsed,minimized:aq.minimized,maximized:aq.maximized});var an=a(au,ar);if(an.length){var ap=an.pagination("options");$.extend(ao,{pageNumber:ap.pageNumber,pageSize:ap.pageSize})}return ao}function a(ao,an){if(!an){an=$.data(ao,"datagrid")}return an.panel.children("div.datagrid-pager")}function aj(aq,ap){if(!ap){ap=$.data(aq,"datagrid")}var ao=ap.options;a(aq,ap).pagination("loading");if(ao.loadMsg){var an=ap.panel;$('<div class="datagrid-mask" style="display:block"></div>').appendTo(an);var ar=$('<div class="datagrid-mask-msg" style="display:block"></div>').html(ao.loadMsg).appendTo(an);ar.css("left",(an.width()-ar._outerWidth())/2)}}function I(ap,ao){if(!ao){ao=$.data(ap,"datagrid")}a(ap,ao).pagination("loaded");var an=ao.panel;an.children("div.datagrid-mask-msg").remove();an.children("div.datagrid-mask").remove()}var E={text:{init:function(ao,aq,an){var ap=$('<input type="text" class="datagrid-editable-input" tabIndex="'+an+'">').appendTo(ao);K(ap,aq);if(aq&&aq.disabled){ap.attr("disabled",true)}if(aq&&aq.required!=undefined){ap.validatebox({required:aq.required})}return ap},getValue:function(an){return $(an).val()},setValue:function(ao,an){$(ao).val(an)},resize:function(ao,an){$(ao)._outerWidth(an)},setEnabled:function(ao,an){$(ao).attr("disabled",!an)}},textarea:{init:function(ao,aq,an){var ap=$('<textarea class="datagrid-editable-input" tabIndex="'+an+'"></textarea>').appendTo(ao);K(ap,aq);return ap},getValue:function(an){return $(an).val()},setValue:function(ao,an){$(ao).val(an)},resize:function(ao,an){$(ao)._outerWidth(an)},setEnabled:function(ao,an){$(ao).attr("disabled",!an)}},checkbox:{init:function(ao,aq,an){var ap=$('<input type="checkbox" tabIndex="'+an+'">').appendTo(ao);ap.val(aq.on);ap.attr("offval",aq.off);K(ap,aq);return ap},getValue:function(an){if($(an).is(":checked")){return $(an).val()}else{return $(an).attr("offval")}},setValue:function(ap,ao){var an=false;if($(ap).val()==ao){an=true}$.fn.prop?$(ap).prop("checked",an):$(ap).attr("checked",an)},setEnabled:function(ao,an){$(ao).attr("disabled",!an)}},numberbox:{init:function(ao,aq,an){var ap=$('<input type="text" class="datagrid-editable-input" tabIndex="'+an+'">').appendTo(ao);ap.numberbox(aq);if(aq&&aq.change){ap.change(function(){$(this).numberbox("setValue",$(this).val());aq.change.call(this)})}return ap},destroy:function(an){$(an).numberbox("destroy")},getValue:function(an){return $(an).numberbox("getValue")},setValue:function(ao,an){$(ao).numberbox("setValue",an)},resize:function(ao,an){$(ao)._outerWidth(an)},setEnabled:function(ao,an){$(ao).attr("disabled",!an)}},validatebox:{init:function(ao,aq,an){var ap=$('<input type="text" class="datagrid-editable-input" tabIndex="'+an+'">').appendTo(ao);ap.validatebox(aq);K(ap,aq);return ap},destroy:function(an){$(an).validatebox("destroy")},getValue:function(an){return $(an).val()},setValue:function(ao,an){$(ao).val(an)},resize:function(ao,an){$(ao)._outerWidth(an)},setEnabled:function(ao,an){$(ao).attr("disabled",!an)}},datebox:{init:function(ao,aq,an){var ap=$('<input type="text" tabIndex="'+an+'">').appendTo(ao);ap.datebox(aq);K(ap,aq);return ap},destroy:function(an){$(an).datebox("destroy")},getValue:function(an){return $(an).datebox("getValue")},setValue:function(ao,an){$(ao).datebox("setValue",an)},resize:function(ao,an){$(ao).datebox("resize",an)},setEnabled:function(ao,an){if(an){$(ao).datebox("enable")}else{$(ao).datebox("disable")}}},combobox:{init:function(ao,ap,an){var aq=$('<input type="text" tabIndex="'+an+'">').appendTo(ao);aq.combobox(ap||{});return aq},destroy:function(an){$(an).combobox("destroy")},getValue:function(an){return $(an).combobox("getValue")},setValue:function(ao,an,ap){$(ao).combobox("setValueText",{value:an,text:ap})},resize:function(ao,an){$(ao).combobox("resize",an)},setEnabled:function(ao,an){if(an){$(ao).combobox("enable")}else{$(ao).combobox("disable")}}},combotree:{init:function(ao,ap,an){var aq=$('<input type="text" tabIndex="'+an+'">').appendTo(ao);aq.combotree(ap);return aq},destroy:function(an){$(an).combotree("destroy")},getValue:function(an){return $(an).combotree("getValue")},setValue:function(ao,an,ap){$(ao).combotree("setValueText",{value:an,text:ap})},resize:function(ao,an){$(ao).combotree("resize",an)},setEnabled:function(ao,an){if(an){$(ao).combotree("enable")}else{$(ao).combotree("disable")}}}};$.fn.datagrid.methods={options:function(an){return ac(an[0])},getPanel:function(an){return $.data(an[0],"datagrid").panel},getPager:function(an){return a(an[0])},getToolbar:function(an){return $.data(an[0],"datagrid").panel.find("div.datagrid-toolbar")},getColumnFields:function(ao,an){return i(ao[0],an)},getColumnOption:function(ao,an){return U(ao[0],an)},resize:function(ao,an){return ao.each(function(){P(this,an)})},load:function(ao,an){return ao.each(function(){var ar=$.data(this,"datagrid");var aq=ac(this,ar);aq.pageNumber=1;var ap=a(this,ar);ap.pagination({pageNumber:1});d(this,an,ar)})},reload:function(ao,an){return ao.each(function(){d(this,an)})},reloadFooter:function(ao,an){return ao.each(function(){var ar=$.data(this,"datagrid");var aq=ar.options;var ap=ar.dc;if(an){ar.footer=an}if(aq.showFooter){aq.view.renderFooter.call(aq.view,this,ap.footer2,false,ar);aq.view.renderFooter.call(aq.view,this,ap.footer1,true,ar);if(aq.view.onAfterRender){aq.view.onAfterRender.call(aq.view,this,ar)}l(this,undefined,undefined,ar)}})},loading:function(an){return an.each(function(){aj(this)})},loaded:function(an){return an.each(function(){I(this)})},fitColumns:function(an){return an.each(function(){o(this)})},fixColumnSize:function(ao,an){return ao.each(function(){L(this,an)})},fixRowHeight:function(ao,an){return ao.each(function(){l(this,an)})},autoSizeColumn:function(ao,an){return ao.each(function(){Q(this,an)})},loadData:function(ao,an){return ao.each(function(){t(this,an);W(this)})},getData:function(an){return $.data(an[0],"datagrid").data},getRows:function(an){return $.data(an[0],"datagrid").data.rows},getRowByIndex:function(ao,an){return $.data(ao[0],"datagrid").data.rows[an]},getFooterRows:function(an){return $.data(an[0],"datagrid").footer},getRowIndex:function(ao,an){return X(ao[0],an)},getChecked:function(ar){var ao=[];var aq=$.data(ar[0],"datagrid");var ap=aq.data.rows;var an=aq.dc;an.body1.add(an.body2).find("table.datagrid-btable").find("div.datagrid-cell-check input:checked").each(function(au,av){var at=$(this).parents("tr.datagrid-row:first").attr("datagrid-row-index");au.push(av[at])},[ao,ap]);return ao},getSelected:function(ao){var an=T(ao[0]);return an.length>0?an[0]:null},getSelections:function(an){return T(an[0])},clearSelections:function(an){return an.each(function(){var ao=$.data(this,"datagrid");var ap=ao.selectedRows;ap.splice(0,ap.length);Z(this,undefined,ao)})},selectAll:function(an){return an.each(function(){ag(this)})},unselectAll:function(ao,an){return ao.each(function(){Z(this,an)})},selectRow:function(ao,an){return ao.each(function(){aa(this,an)})},selectRecord:function(ao,an){return ao.each(function(){R(this,an)})},unselectRow:function(ao,an){return ao.each(function(){S(this,an)})},checkRow:function(ao,an){return ao.each(function(){al(this,an)})},uncheckRow:function(ao,an){return ao.each(function(){k(this,an)})},checkAll:function(an){return an.each(function(){c(this)})},uncheckAll:function(an){return an.each(function(){s(this)})},beginEdit:function(ao,an){return ao.each(function(){z(this,an)})},endEdit:function(an){return an.each(function(){ah(this,false)})},cancelEdit:function(an){return an.each(function(){ah(this,true)})},getEditors:function(an){return ad(an[0])},getEditor:function(ao,an){return H(ao[0],an)},refreshRow:function(ao,an){return ao.each(function(){var aq=$.data(this,"datagrid");var ap=aq.options;ap.view.refreshRow.call(ap.view,this,an,aq)})},validateRow:function(an){return ak(an[0])},updateRow:function(ao,an){return ao.each(function(){var aq=$.data(this,"datagrid");var ap=aq.options;ap.view.updateRow.call(ap.view,this,an.index,an.row,aq)})},updateCell:function(ao,an){return ao.each(function(){var aq=$.data(this,"datagrid");var ap=aq.options;ap.view.updateCell.call(ap.view,this,an.index,an.field,aq)})},appendRow:function(ao,an){return ao.each(function(){C(this,an)})},hideEditorTool:function(an){return an.each(function(){u(this)})},insertRow:function(ao,an){return ao.each(function(){q(this,an)})},deleteRow:function(ao,an){return ao.each(function(){M(this,an)})},getChanges:function(ao,an){return V(ao[0],an)},acceptChanges:function(an){return an.each(function(){O(this)})},rejectChanges:function(an){return an.each(function(){p(this)})},mergeCells:function(ao,an){return ao.each(function(){g(this,an)})},showColumn:function(ao,an){return ao.each(function(){var ar=$.data(this,"datagrid");var ap=ar.panel;ap.find('td[field="'+an+'"]').show();var aq=U(this,an,ar);if(aq){aq.hidden=false;o(this,ar)}})},hideColumn:function(ao,an){return ao.each(function(){var ar=$.data(this,"datagrid");var ap=ar.panel;ap.find('td[field="'+an+'"]').hide();var aq=U(this,an,ar);if(aq){aq.hidden=true;o(this,ar)}})},fixColumnTitle:function(ao,an){return G(ao[0],an)},getColsWidth:function(an){return A(an[0])},getColsHide:function(an){return Y(an[0])},getPageCount:function(ao){var an=a(ao[0]);if(an.length){return an.pagination("getPageCount")}return 1},getTotalCount:function(an){return $.data(an[0],"datagrid").options.total},setEditor:function(ao,an){j(ao[0],an)},isEditing:function(an){return x(an[0])},search:function(ao,an){return F(ao[0],an)},refreshGrid:function(an){return an.each(function(){af(this)})}};$.fn.datagrid.parseOptions=function(ap){var ao=$(ap);var an=ao.attr("class")+"";if(an.indexOf("easyui-")<0){return{id:ao.attr("id")}}return $.extend({},$.fn.panel.parseOptions(ap),$.parser.parseOptions(ap,["url","toolbar","idField","sortName","sortOrder","pagePosition",{fitColumns:"boolean",autoRowHeight:"boolean",striped:"boolean",nowrap:"boolean"},{rownumbers:"boolean",singleSelect:"boolean",checkOnSelect:"boolean",selectOnCheck:"boolean"},{pagination:"boolean",pageSize:"number",pageNumber:"number"},{remoteSort:"boolean",showHeader:"boolean",showFooter:"boolean"},{scrollbarSize:"number"}]),{pageList:(ao.attr("pageList")?eval(ao.attr("pageList")):undefined),loadMsg:(ao.attr("loadMsg")),rowStyler:(ao.attr("rowStyler")?eval(ao.attr("rowStyler")):undefined)})};var ae={render:function(aw,ar,an,aq){if(ar.length==0){return}if(!aq){aq=$.data(aw,"datagrid")}var ao=aq.options;var aA=aq.data.rows;var au=i(aw,an,aq);if(an){if(!(ao.rownumbers||(ao.frozenColumns&&ao.frozenColumns.length))){return}}ar.children(".datagrid-btable,.datagrid-emptybody").remove();if(aA.length>0){var ay=['<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>'];for(var at=0,av=aA.length;at<av;at++){var ax;if(ao.canNotSelectRow&&ao.canNotSelectRow.call(aw,at,aA[at])){ax=(at%2&&ao.striped)?'class="datagrid-row datagrid-row-alt cannot-select"':'class="datagrid-row cannot-select"'}else{ax=(at%2&&ao.striped)?'class="datagrid-row datagrid-row-alt"':'class="datagrid-row"'}var az=ao.rowStyler?ao.rowStyler.call(aw,at,aA[at]):"";var ap=az?'style="'+az+'"':"";ay.push('<tr datagrid-row-index="'+at+'" '+ax+" "+ap+">");ay.push(this.renderRow.call(this,aw,au,an,at,aA[at],aq));ay.push("</tr>")}ay.push("</tbody></table>");ar.prepend(ay.join(""))}else{ar.prepend('<div class="datagrid-emptybody"/>')}},renderFooter:function(au,ap,an,ao){if(ap.length==0){return}if(!ao){ao=$.data(au,"datagrid")}var aw=ao.footer||[];var ar=i(au,an,ao);var av=['<table class="datagrid-ftable" cellspacing="0" cellpadding="0" border="0"><tbody>'];for(var aq=0,at=aw.length;aq<at;aq++){av.push('<tr class="datagrid-row" datagrid-row-index="'+aq+'">');av.push(this.renderRow.call(this,au,ar,an,aq,aw[aq],ao));av.push("</tr>")}av.push("</tbody></table>");ap.html(av.join(""))},renderEditor:function(at,ao,ar,aq){if(ao.length==0){return}if(!aq){aq=$.data(at,"datagrid")}var an=i(at,ar,aq);var ap=['<table class="datagrid-etable" cellspacing="0" cellpadding="0" border="0"><tbody>'];ap.push('<tr class="datagrid-row datagrid-row-editing datagrid-row-selected" datagrid-row-index="0">');ap.push(this.renderRow.call(this,at,an,ar,0,{},aq));ap.push("</tr></tbody></table>");$(ap.join("")).appendTo(ao)},attrRowIndex:function(ao,an){ao.attr("datagrid-row-index",an)},acceptChanges:function(an){O(an)},rejectChanges:function(an){p(an)},renderRow:function(aF,az,aE,at,ar,ap){if(!ap){ap=$.data(aF,"datagrid")}var au=ap.options;var ay=[];if(aE&&au.rownumbers){var aA=at+1;if(au.pagination){aA+=(au.pageNumber-1)*au.pageSize}ay.push('<td class="datagrid-td-rownumber"><div class="datagrid-cell-rownumber">'+aA+"</div></td>")}for(var aB=0,aC=az.length;aB<aC;aB++){var ao=az[aB];var aq=U(aF,ao,ap);if(aq){var aw=aq.styler?(aq.styler(ar[ao],ar,at)||""):"";var aD=aq.hidden?'style="display:none;'+aw+'"':(aw?'style="'+aw+'"':"");ay.push('<td field="'+ao+'" '+aD+">");aD="";if(!aq.checkbox){aD+="text-align:"+(aq.align||"left")+";";if(!au.nowrap){aD+="white-space:normal;height:auto;"}else{if(au.autoRowHeight){aD+="height:auto;"}}}ay.push('<div style="'+aD+'" ');if(aq.checkbox){ay.push('class="datagrid-cell-check ')}else{ay.push('class="datagrid-cell '+aq.cellClass)}ay.push('">');if(aq.checkbox){if(!aq.checkFormatter){ay.push('<input type="checkbox" name="'+ao+'" value="'+(ar[ao]!=undefined?ar[ao]:"")+'"/>')}else{var an=aq.checkFormatter.call(aq,ar[ao],ar,at);if(typeof an=="string"){ay.push(an)}else{var ax=$.extend({visible:true,checked:false,enabled:true},an);if(ax.visible){var av='<input type="checkbox" name="'+ao+'" value="'+(ar[ao]!=undefined?ar[ao]:"")+'"';if(ax.checked){av+=" checked"}if(!ax.enabled){av+=" disabled"}av+="/>";ay.push(av)}}}}else{if(aq.formatter){ay.push(aq.formatter.call(aq,ar[ao],ar,at))}else{ay.push(ar[ao])}}ay.push("</div>");ay.push("</td>")}}return ay.join("")},refreshRow:function(ar,at,an){if(!an){an=$.data(ar,"datagrid")}var av={};var ap=i(ar,true,an).concat(i(ar,false,an));for(var ao=0,aq=ap.length;ao<aq;ao++){av[ap[ao]]=undefined}var aw=an.data.rows;$.extend(av,aw[at]);this.updateRow.call(this,ar,at,av,an);var au=an.dc;if(au){au.editor2.add(au.editor1).add(au.editorTool).hide()}},updateRow:function(ar,au,ax,ao){if(!ao){ao=$.data(ar,"datagrid")}var an=ao.options;var az;var ay=ao.data.rows;var at=an.finder.getTr(ar,au,au==ao.editing.index?"editor":undefined,undefined,ao);for(var av in ax){ay[au][av]=ax[av];var ap=U(ar,av,ao);if(ap){var aq=at.children('td[field="'+av+'"]');var aw=aq.find("div.datagrid-cell");az=ap.styler?ap.styler(ay[au][av],ay[au],au):"";aq.attr("style",az||"");if(ap.hidden){aq.hide()}if(ap.formatter){aw.html(ap.formatter.call(ap,ay[au][av],ay[au],au))}else{aw.html(ay[au][av])}}}az=an.rowStyler?an.rowStyler.call(ar,au,ay[au]):"";at.attr("style",az||"");l(ar,au,undefined,ao)},updateCell:function(ar,au,av,ao){if(!ao){ao=$.data(ar,"datagrid")}var an=ao.options;var aA;var az=ao.data.rows;var ay=az[au];var at=an.finder.getTr(ar,au,au==ao.editing.index?"editor":undefined,undefined,ao);var ap=U(ar,av,ao);if(ap){var aq=at.children('td[field="'+av+'"]');var ax=aq.find("div.datagrid-cell");var aw=ay[av];aA=ap.styler?ap.styler(aw,aw,au):"";aq.attr("style",aA||"");if(ap.hidden){aq.hide()}if(ap.formatter){ax.html(ap.formatter.call(ap,aw,ay,au))}else{ax.html(aw)}}aA=an.rowStyler?an.rowStyler.call(ar,au,ay):"";at.attr("style",aA||"");l(ar,au,undefined,ao)},insertRow:function(ax,aw,aA,ao){if(!ao){ao=$.data(ax,"datagrid")}var an=ao.options;var az=ao.dc;var au=ao.data;if(aw==undefined||aw==null||aw>au.rows.length){aw=au.rows.length}for(var av=au.rows.length-1;av>=aw;av--){an.finder.getTr(ax,av,"body",2,ao).attr("datagrid-row-index",av+1);var ay=an.finder.getTr(ax,av,"body",1,ao).attr("datagrid-row-index",av+1);if(an.rownumbers){ay.find("div.datagrid-cell-rownumber").html(av+2)}}var aq=i(ax,true,ao);var ap=i(ax,false,ao);var at='<tr class="datagrid-row" datagrid-row-index="'+aw+'">'+this.renderRow.call(this,ax,aq,true,aw,aA,ao)+"</tr>";var ar='<tr class="datagrid-row" datagrid-row-index="'+aw+'">'+this.renderRow.call(this,ax,ap,false,aw,aA,ao)+"</tr>";if(aw>=au.rows.length){if(au.rows.length){an.finder.getTr(ax,"","last",1,ao).after(at);an.finder.getTr(ax,"","last",2,ao).after(ar)}else{az.body1.add(az.body2).children(".datagrid-btable,.datagrid-emptybody").remove();az.body1.prepend('<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>'+at+"</tbody></table>");az.body2.prepend('<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>'+ar+"</tbody></table>")}}else{an.finder.getTr(ax,aw+1,"body",1,ao).before(at);an.finder.getTr(ax,aw+1,"body",2,ao).before(ar)}au.total+=1;au.rows.splice(aw,0,aA);this.refreshRow.call(this,ax,aw,ao);ao.editing.insertedIndex=aw},deleteRow:function(av,ap,au){if(!au){au=$.data(av,"datagrid")}var ar=au.options;var at=au.data;if(at.rows.length>1){ar.finder.getTr(av,ap,undefined,undefined,au).remove();for(var aq=ap+1,ao=at.rows.length;aq<ao;aq++){ar.finder.getTr(av,aq,"body",2,au).attr("datagrid-row-index",aq-1);var an=ar.finder.getTr(av,aq,"body",1,au).attr("datagrid-row-index",aq-1);if(ar.rownumbers){an.find("div.datagrid-cell-rownumber").html(aq)}}}else{$('<div class="datagrid-emptybody"/>').width(au.dc.body2.find("table").width()).height(1).appendTo(au.dc.body2);ar.finder.getTr(av,ap,undefined,undefined,au).remove()}at.total-=1;at.rows.splice(ap,1)},onBeforeRender:function(ap,ao,an){},onAfterRender:function(ap,ao){if(!ao){ao=$.data(ap,"datagrid")}var an=ao.options;if(an.showFooter){var aq=ao.panel.find("div.datagrid-footer");aq.find("div.datagrid-cell-rownumber,div.datagrid-cell-check").css("visibility","hidden")}}};$.fn.datagrid.defaults=$.extend({},$.fn.panel.defaults,{frozenColumns:undefined,columns:undefined,fitColumns:false,autoRowHeight:true,toolbar:null,striped:false,method:"post",nowrap:true,idField:null,url:null,loadMsg:"Processing, please wait ...",rownumbers:false,singleSelect:false,selectOnCheck:true,checkOnSelect:true,pagination:false,pagePosition:"bottom",pageNumber:1,pageSize:20,pageList:[20,50,100],queryParams:{},sortName:[],sortOrder:[],sortNumber:new Array("①","②","③","④","⑤","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳"),remoteSort:true,showHeader:true,showFooter:false,scrollbarSize:18,canSearch:false,showSearch:false,canHideColumn:false,readonly:false,showEditorTool:false,autoEndEdit:true,total:0,searchFields:undefined,onSearch:undefined,onLastColEnter:undefined,hideColComboWidth:120,appendCopyLastRow:false,initNotQuery:false,rowStyler:function(ao,an){},loader:function(aq,ap,an){var ao=ac(this);if(!ao.url){return false}$.ajax({type:ao.method,url:ao.url,data:aq,dataType:"json",success:function(ar){ap(ar)},error:function(){an.apply(this,arguments)}})},loadFilter:function(an){if(typeof an.length=="number"&&typeof an.splice=="function"){return{total:an.length,rows:an}}else{return an}},canNotSelectRow:function(ao,an){},editors:E,finder:{getTr:function(au,at,av,ap,ao){if(!ao){ao=$.data(au,"datagrid")}av=av||"body";ap=ap||0;var aw=ao.dc;var an=ao.options;if(ap==0){var ar=an.finder.getTr(au,at,av,1,ao);var aq=an.finder.getTr(au,at,av,2,ao);return ar.add(aq)}else{if(av=="body"){return(ap==1?aw.body1:aw.body2).find(">table>tbody>tr[datagrid-row-index="+at+"]")}else{if(av=="footer"){return(ap==1?aw.footer1:aw.footer2).find(">table>tbody>tr[datagrid-row-index="+at+"]")}else{if(av=="selected"){return(ap==1?aw.body1:aw.body2).find(">table>tbody>tr.datagrid-row-selected")}else{if(av=="last"){return(ap==1?aw.body1:aw.body2).find(">table>tbody>tr:last[datagrid-row-index]")}else{if(av=="allbody"){return(ap==1?aw.body1:aw.body2).find(">table>tbody>tr[datagrid-row-index]")}else{if(av=="allfooter"){return(ap==1?aw.footer1:aw.footer2).find(">table>tbody>tr[datagrid-row-index]")}else{if(av=="editor"){return(ap==1?aw.editor1:aw.editor2).find(">table>tbody>tr[datagrid-row-index]")}}}}}}}}},getRow:function(ap,an,ao){if(!ao){ao=$.data(ap,"datagrid")}return ao.data.rows[an]}},view:ae,onBeforeLoad:function(an){},onLoadSuccess:function(){},onLoadError:function(){},onClickRow:function(ao,an){},onDblClickRow:function(ao,an){},onClickCell:function(ap,ao,an){},onDblClickCell:function(ap,ao,an){},onResizeColumn:function(ao,an){},onSelect:function(ao,an){},onUnselect:function(ao,an){},onSelectAll:function(an){},onUnselectAll:function(an){},onCheck:function(ao,an){},onUncheck:function(ao,an){},onCheckAll:function(an){},onUncheckAll:function(an){},onBeforeEdit:function(ao,an){},onAfterEdit:function(ap,ao,an){},onCancelEdit:function(ao,an){},onEndEdit:function(ao,an){},onHeaderContextMenu:function(ao,an){},onRowContextMenu:function(ao,ap,an){},onEditorBtnClick:function(an){if(an){ah(this,false)}else{ah(this,true)}}})})(jQuery);