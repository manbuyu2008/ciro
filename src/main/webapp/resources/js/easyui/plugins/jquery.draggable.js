(function(g){var d=false;function c(o,k){if(!k){k=g.data(o.data.target,"draggable")}var j=k.options;var n=o.data;var m=n.startLeft+o.pageX-n.startX;var l=n.startTop+o.pageY-n.startY;if(j.deltaX!=null&&j.deltaX!=undefined){m=o.pageX+j.deltaX}if(j.deltaY!=null&&j.deltaY!=undefined){l=o.pageY+j.deltaY}if(o.data.parent!=document.body){var i=g(o.data.parent);m+=i.scrollLeft();l+=i.scrollTop()}if(j.axis=="h"){n.left=m}else{if(j.axis=="v"){n.top=l}else{n.left=m;n.top=l}}}function f(m,k){var l=m.data.target;if(!k){k=g.data(l,"draggable")}var j=k.options;var i=k.proxy;if(!i){i=g(m.data.target)}i.css({left:m.data.left,top:m.data.top});g("body").css("cursor",j.cursor)}function a(o){var n=o.data.target;var m=g.data(n,"draggable");d=true;var l=m.options;var p=n.id,k=m.options.accept;m.droppables=g(".droppable").filter(function(){return p!=this.id}).filter(function(){if(k){return g(k).filter(function(){return this.id==p}).length>0}else{return true}});var j=m.proxy,i=g(n);if(!j){if(l.proxy){if(l.proxy=="clone"){j=i.clone().insertAfter(n)}else{j=l.proxy.call(n,n)}m.proxy=j}else{j=i}}j.css("position","absolute");c(o,m);f(o,m);l.onStartDrag.call(n,o);return false}function b(k){var j=k.data.target;var i=g.data(j,"draggable");c(k,i);if(i.options.onDrag.call(j,k)!=false){f(k,i)}i.droppables.each(function(n,m){var o=g(this);var l=o.offset();if(n.pageX>l.left&&n.pageX<l.left+o.outerWidth()&&n.pageY>l.top&&n.pageY<l.top+o.outerHeight()){if(!this.entered){o.trigger("_dragenter",[m]);this.entered=true}o.trigger("_dragover",[m])}else{if(this.entered){o.trigger("_dragleave",[m]);this.entered=false}}},[k,j]);return false}function e(o){var p=o.data.target;var j=g.data(p,"draggable");d=false;c(o,j);var r=j.proxy;var i=j.options,l=g(p);if(i.revert){if(q(o,p,j)==true){m(j,r);l.css({position:o.data.startPosition,left:o.data.startLeft,top:o.data.startTop})}else{var k=p.id;if(r){r.animate({left:o.data.startLeft,top:o.data.startTop},function(){var t=g("#"+k)[0];var s=g.data(t,"draggable");m(s,s.proxy)})}else{var n=o.data.startPosition;l.animate({left:o.data.startLeft,top:o.data.startTop},function(){g("#"+k).css("position",n)})}}}else{l.css({position:"absolute",left:o.data.left,top:o.data.top});m(j,r);q(o,p,j)}i.onStopDrag.call(o.data.target,o);g(document).unbind(".draggable");setTimeout(function(){g("body").css("cursor","")},100);function m(t,s){if(s){s.remove()}t.proxy=null}function q(u,t,s){var v=false;s.droppables.each(function(A,z,x){var B=g(this),w=g(z);var y=B.offset();if(A.pageX>y.left&&A.pageX<y.left+B.outerWidth()&&A.pageY>y.top&&A.pageY<y.top+B.outerHeight()){if(x.options.revert){w.css({position:A.data.startPosition,left:A.data.startLeft,top:A.data.startTop})}B.trigger("_drop",[z]);v=true;this.entered=false}},[u,t,s]);return v}return false}function h(k,j){if(!j){j=g.data(k,"draggable")}j.handle.unbind(".draggable").bind("mousemove.draggable",{target:k},function(n){if(d){return}var m=g.data(n.data.target,"draggable");var l=m.options;if(i(n,m)){g(this).css("cursor",l.cursor)}else{g(this).css("cursor","")}}).bind("mouseleave.draggable",{target:k},function(l){g(this).css("cursor","")}).bind("mousedown.draggable",{target:k},function(q){var p=g.data(q.data.target,"draggable");if(i(q,p)==false){return}g(this).css("cursor","");var m=g(q.data.target);var l=m.position();var o={startPosition:g(q.data.target).css("position"),startLeft:l.left,startTop:l.top,left:l.left,top:l.top,startX:q.pageX,startY:q.pageY,target:q.data.target,parent:m.parent()[0]};g.extend(q.data,o);var n=p.options;if(n.onBeforeDrag.call(q.data.target,q)==false){return}var r=g(document);r.bind("mousedown.draggable",q.data,a);r.bind("mousemove.draggable",q.data,b);r.bind("mouseup.draggable",q.data,e)});function i(u,n){var o=g(n.handle);var s=o.offset();var p=o.outerWidth();var w=o.outerHeight();var x=u.pageY-s.top;var m=s.left+p-u.pageX;var v=s.top+w-u.pageY;var q=u.pageX-s.left;return Math.min(x,m,v,q)>n.options.edge}}g.fn.draggable=function(i,j){if(typeof i=="string"){return g.fn.draggable.methods[i](this,j)}return this.each(function(k){var l;var n=g.data(this,"draggable");var o=g(this);if(n){n.handle.unbind(".draggable");l=g.extend(n.options,k)}else{l=g.extend({},g.fn.draggable.defaults,g.fn.draggable.parseOptions(this),k||{});if(!this.id){this.id=g.parser.getObjGUID()}}if(l.disabled==true){o.css("cursor","");return}var m=null;if(typeof l.handle=="undefined"||l.handle==null){m=o}else{m=(typeof l.handle=="string"?g(l.handle,this):l.handle)}n=g.data(this,"draggable",{options:l,handle:m});h(this,n)},[i])};g.fn.draggable.methods={options:function(i){return g.data(i[0],"draggable").options},proxy:function(i){return g.data(i[0],"draggable").proxy},enable:function(i){return i.each(function(){g(this).draggable({disabled:false})})},disable:function(i){return i.each(function(){g(this).draggable({disabled:true})})}};g.fn.draggable.parseOptions=function(j){var i=g(j);return g.extend({},g.parser.parseOptions(j,["cursor","handle","axis",{revert:"boolean",deltaX:"number",deltaY:"number",edge:"number"}]),{disabled:(i.prop("disabled")?true:undefined)})};g.fn.draggable.defaults={proxy:null,revert:false,cursor:"move",deltaX:null,deltaY:null,handle:null,disabled:false,edge:0,axis:null,onBeforeDrag:function(i){},onStartDrag:function(i){},onDrag:function(i){},onStopDrag:function(i){}}})(jQuery);